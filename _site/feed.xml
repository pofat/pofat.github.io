<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.8.5">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2020-09-17T00:56:52+08:00</updated><id>http://localhost:4000/</id><title type="html">Pofat Develops</title><subtitle>#0x8badf00d ğŸ¤®</subtitle><author><name>true</name></author><entry><title type="html">å¦‚ä½•æ›´ç²¾æº–åœ°æ¸¬è©¦ Reactive Programmingï¼ˆä¸€ï¼‰</title><link href="http://localhost:4000/2020/09/17/Precise-Tests-In-Reactive-Programming-I.html" rel="alternate" type="text/html" title="å¦‚ä½•æ›´ç²¾æº–åœ°æ¸¬è©¦ Reactive Programmingï¼ˆä¸€ï¼‰" /><published>2020-09-17T00:00:00+08:00</published><updated>2020-09-17T00:00:00+08:00</updated><id>http://localhost:4000/2020/09/17/Precise-Tests-In-Reactive-Programming-I</id><content type="html" xml:base="http://localhost:4000/2020/09/17/Precise-Tests-In-Reactive-Programming-I.html">&lt;p&gt;Functional Reactive Programming é¡¯ç„¶æ˜¯é€™äº›å¹´çš„é–‹ç™¼æ¨¡å¼é¡¯å­¸ä¹‹ä¸€ï¼Œå°¤å…¶æ˜¯ Apple ä¹Ÿæ¨å‡ºäº†è‡ªå·±çš„æ–¹æ¡ˆ - &lt;a href=&quot;https://developer.apple.com/documentation/combine&quot;&gt;Combine&lt;/a&gt;ï¼Œç”±æ­¤å¯è¦‹å…¶é‡è¦æ€§ã€‚åŸºæœ¬ä¸Š Reactive Programming æ˜¯å°‡éåŒæ­¥çš„äº‹ä»¶ï¼ŒåŠ ä¸Šæ™‚é–“é€™å€‹ç¶­åº¦ï¼Œä»¥è®Šæˆä¸€å€‹é¢å‘è³‡æ–™ä¸²æµçš„é–‹ç™¼å…¸ç¯„ï¼Œè€Œé€™å€‹ç™¼å°„äº‹ä»¶çš„ä¸»é«”ï¼Œåœ¨ä¸åŒçš„ FRP æ¡†æ¶å„ç”±ä¸åŒè§’è‰²æ“”ç•¶ï¼Œ ReactiveCocoa æ˜¯ Signalï¼ŒRxSwift æ˜¯ Observableï¼ŒCombine å°±æ˜¯ Publisherï¼Œä»Šå¤©çš„ä¸»è§’æœƒæ˜¯ RxSwiftï¼Œä¸é Combine èˆ‡å®ƒçš„æ¦‚å¿µå¹¾ä¹éƒ½æ˜¯ç›¸é€šçš„ï¼Œç‰©ä»¶é–“çš„å°æ‡‰é—œä¿‚ä¹Ÿå¹¾ä¹æ˜¯ 1:1ï¼Œ æ‰€ä»¥åŒæ¨£çš„æ¦‚å¿µä¹Ÿå®Œå…¨é©ç”¨ã€‚&lt;/p&gt;

&lt;p&gt;Observable çš„è§€å¿µä¸€çœ‹ Rx å®¶æ—ç”¨ä¾†èªªæ˜ Observable çš„ç¤ºæ„åœ–å°±èƒ½æ›´å®¹æ˜“åœ°æ˜ç™½ï¼ˆ&lt;a href=&quot;http://reactivex.io/documentation/observable.html&quot;&gt;åœ–ç‰‡ä¾†æº&lt;/a&gt;ï¼‰
&lt;img src=&quot;/Users/pofat/Library/Application Support/typora-user-images/image-20200916222940985.png&quot; alt=&quot;image-20200916222940985&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ç”±æ­¤å¯çŸ¥ Observable å¯è¦–ç‚ºç”¨æ™‚é–“ç‚º index çš„ event collection ï¼Œè‹¥æ˜¯ collection é‚£éº¼æˆ‘å€‘æ‰€ç†Ÿçš„ high-order function ï¼Œé€™äº›å¾ FP ä¾†çš„æ¦‚å¿µä¹Ÿå¯ä»¥å¥—ç”¨åœ¨ Observbale ä¸Šï¼Œå› æ­¤ mapã€flatMapç­‰é€™äº›ç†Ÿæ‚‰çš„ä¼™ä¼´å€‘éƒ½å‡ºç¾äº†ï¼Œé€™å³æ˜¯ FRP è£¡ F çš„éƒ¨åˆ†ã€‚&lt;/p&gt;

&lt;h2 id=&quot;æ¸¬è©¦æ™‚é–“æœ‰é»é›£&quot;&gt;æ¸¬è©¦æ™‚é–“æœ‰é»é›£&lt;/h2&gt;

&lt;p&gt;é‚£ä»Šå¤©çš„ä¸»é¡Œæ˜¯ä»€éº¼å‘¢ï¼Ÿæˆ‘å€‘çŸ¥é“ Observable ç™¼å‡ºä¾†çš„éƒ½æ˜¯éåŒæ­¥äº‹ä»¶ï¼Œæ‰€ä»¥åœ¨æ¸¬è©¦ç”¨äº† Observbale çš„ç¨‹å¼ç¢¼æ™‚ï¼Œå¦‚æœç‰½æ‰¯åˆ° thread çš„åˆ‡æ›ï¼Œé‚£ä½ å°±å¾—ä½¿ç”¨éåŒæ­¥çš„æ¸¬è©¦æ–¹å¼ ï¼ˆæ¯”å¦‚ &lt;code class=&quot;highlighter-rouge&quot;&gt;XCTWaiter&lt;/code&gt;ï¼‰ï¼Œä¸€å€‹é©ç•¶çš„æ¸¬è©¦æ‡‰è©² Observable è£¡çš„äº‹ä»¶ä¾†æºå…¶å¯¦éƒ½æ˜¯ç”¨ mock ä¾†å–ä»£çœŸæ­£çš„éåŒæ­¥å·¥ä½œï¼Œæ‰€ä»¥ä¸€å®šå¾ˆå¿«ï¼Œå¯æƒœä½ ä»ç„¶éœ€è¦ç‚ºé€™ç¨®æ¸¬è©¦æ–¹å¼è¨­ä¸€å€‹ç­‰å¾…çš„æ™‚é–“ï¼›æ›´å›°é›£çš„å•é¡Œæ˜¯æ™‚é–“æ˜¯è¤‡é›œçš„ï¼Œå¦‚æœæˆ‘å€‘æƒ³è¦æ›´ç²¾æº–åœ°é©—ç¢ºä¸€å€‹å·¥ä½œå‰é–‹å§‹ã€ä¸­é–“ä»¥åŠçµæŸæ™‚çš„ç‹€æ…‹å°±æœƒæŠŠæ¸¬è©¦è®Šå¾—å¾ˆè¤‡é›œã€‚ä½†åˆ¥å¿˜äº†åˆ©ç”¨ time ç•¶ index çš„ event collection é€™å€‹æ¦‚å¿µï¼Œè‹¥æˆ‘å€‘èƒ½å¯¦åšçš„è©±æ˜¯ä¸æ˜¯å°±èƒ½æ§åˆ¶æ™‚é–“ï¼Œæ¸¬è©¦ä¹Ÿèƒ½åšå¾—æ›´æ˜ç¢ºåš´è¬¹ï¼è€Œ RxSwift å°±æä¾›äº† RxTest é€™å€‹é™„åŠ çš„æ¡†æ¶ä¾†å¹«å¿™é€™ä»¶äº‹ï¼Œå°±ä¸€èµ·ç†è§£ä¸€ä¸‹é€™ä»¶äº‹æ˜¯æ€éº¼è¾¦åˆ°çš„ã€‚&lt;/p&gt;

&lt;p&gt;å…ˆçœ‹å€‹ä¾‹å­ï¼Œä¸€å€‹å¯ä»¥æ‰“ request èˆ‡æœ‰å€‹ String çµæœ Observable çš„ ViewModel&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-swift&quot; data-lang=&quot;swift&quot;&gt;&lt;span class=&quot;kd&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Dependency&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Observable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;scheduler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;SchedulerType&lt;/span&gt;

&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;



&lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;ViewModel&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

  &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;dependency&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Dependency&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Observable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;

  &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;resultRelay&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;PublishRelay&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

  &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;bag&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;DisposeBag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

   

  &lt;span class=&quot;nf&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;dependency&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Dependency&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

&lt;span class=&quot;err&quot;&gt;â€‹&lt;/span&gt;    &lt;span class=&quot;k&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dependency&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dependency&lt;/span&gt;

&lt;span class=&quot;err&quot;&gt;â€‹&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;resultRelay&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;asObservable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;



  &lt;span class=&quot;kd&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;doRequest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

&lt;span class=&quot;err&quot;&gt;â€‹&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;dependency&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;err&quot;&gt;â€‹&lt;/span&gt;      &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;observeOn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dependency&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;scheduler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;err&quot;&gt;â€‹&lt;/span&gt;      &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;subscribe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;onNext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;weak&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;resultRelay&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;accept&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;

&lt;span class=&quot;err&quot;&gt;â€‹&lt;/span&gt;      &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;disposed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;by&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;ç„¶å¾Œä¸€èˆ¬åˆ©ç”¨ waiter çš„éåŒæ­¥æ¸¬è©¦æœƒåƒï¼š&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-swift&quot; data-lang=&quot;swift&quot;&gt;&lt;span class=&quot;kd&quot;&gt;extension&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Dependency&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

  &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;mock&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Dependency&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

&lt;span class=&quot;err&quot;&gt;â€‹&lt;/span&gt;    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Observable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;just&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;mock&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

  &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;scheduler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;ConcurrentDispatchQueueScheduler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;qos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;background&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;



&lt;span class=&quot;kd&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;testMockedRequest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;results&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]()&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;vm&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;ViewModel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mock&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;vm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;

&lt;span class=&quot;err&quot;&gt;â€‹&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;observeOn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;ConcurrentDispatchQueueScheduler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;qos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;background&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;err&quot;&gt;â€‹&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;subscribe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;onNext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;results&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;

&lt;span class=&quot;err&quot;&gt;â€‹&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;disposed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;by&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

   

  &lt;span class=&quot;n&quot;&gt;vm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;doRequest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;XCTWaiter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;wait&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;XCTestExpectation&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()],&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;timeout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

  &lt;span class=&quot;kt&quot;&gt;XCTAssertEqual&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;results&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;mock&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;æŠŠéåŒæ­¥è®ŠæˆåŒæ­¥&quot;&gt;æŠŠéåŒæ­¥è®ŠæˆåŒæ­¥&lt;/h2&gt;

&lt;p&gt;é‚£æ¥ä¸‹ä¾†è¦æ€éº¼æ§åˆ¶æ™‚é–“å‘¢ï¼Ÿç¬¬ä¸€ä»¶äº‹è¦æŠŠé€™äº›éåŒæ­¥çš„å‹•ä½œéƒ½è®ŠæˆåŒæ­¥çš„ï¼Œæˆ‘å€‘æ‰æœ‰å¯èƒ½æ§åˆ¶å®ƒï¼Œè®Šæˆä¸€å€‹ä»¥ time ç‚º index çš„ event collectionã€‚è¦åšåˆ°é€™ä»¶äº‹éœ€è¦å…ˆäº†è§£ RxSwift è£¡çš„ &lt;code class=&quot;highlighter-rouge&quot;&gt;SchedulerType&lt;/code&gt; å¹¹å•¥ç”¨çš„ ï¼ˆåœ¨ Combine å°±æ˜¯ &lt;code class=&quot;highlighter-rouge&quot;&gt;Scheduler&lt;/code&gt;ï¼‰ï¼Ÿ &lt;code class=&quot;highlighter-rouge&quot;&gt;SchdulerType&lt;/code&gt; ç¹¼æ‰¿è‡ª &lt;code class=&quot;highlighter-rouge&quot;&gt;ImmediateSchedulerType&lt;/code&gt;ï¼Œå…±æœ‰ä¸€å€‹ property &lt;code class=&quot;highlighter-rouge&quot;&gt;var now : RxTime { get }&lt;/code&gt; å’Œä¸‰å€‹ method ï¼Œåˆ†åˆ¥æ˜¯ä¸‰ç¨® scheduleï¼šç«‹åˆ»é¦¬ä¸Šåšï¼Œå»¶å¾Œä¸€æ®µæ™‚é–“å†åšèˆ‡é€±æœŸæ€§åœ°åšï¼Œå…¶å¯¦ scheduler çš„åŠŸèƒ½å°±æ˜¯è¦æœ‰å€‹ now åšç‚ºæ™‚é–“è»¸èµ·é»çš„åƒè€ƒé»ï¼Œç„¶å¾Œä¸åŒæ™‚é–“é»å°ä¸åŒçš„äº‹æƒ…åšæ’ç¨‹åœ¨ä¸åŒçš„ thread ä¸Šã€‚å…·é«”åœ°ä¾†èªª RxSwift æœ‰  &lt;code class=&quot;highlighter-rouge&quot;&gt;MainScheduler&lt;/code&gt; (main thread)ï¼Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;DispatchQueueScheduler&lt;/code&gt; ï¼ˆåŒ…è£ GCDï¼‰ä»¥åŠ&lt;code class=&quot;highlighter-rouge&quot;&gt; OperationQueueScheduler&lt;/code&gt; ï¼ˆåŒ…è£ OperationQueueï¼‰ï¼› åœ¨ Combine ä¸­ï¼Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;DispatchQueue&lt;/code&gt;ï¼Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;OperationQueue&lt;/code&gt;èˆ‡ &lt;code class=&quot;highlighter-rouge&quot;&gt;RunLoop&lt;/code&gt; æœ¬èº«éƒ½éµå¾ª &lt;code class=&quot;highlighter-rouge&quot;&gt;Scheduler&lt;/code&gt; äº†ï¼Œæ›´ç‚ºé è¿‘åŸæœ¬çš„ç”¨æ³•ç¿’æ…£ã€‚&lt;/p&gt;

&lt;p&gt;æœ¬æ–‡å…ˆåªçœ‹ç¬¬ä¸€ç¨®ç«‹åˆ»é¦¬ä¸Šè¦åšçš„ &lt;code class=&quot;highlighter-rouge&quot;&gt;func schedule&amp;lt;StateType&amp;gt;(_ state: StateType, action: @escaping (StateType) -&amp;gt; Disposable) -&amp;gt; Disposable&lt;/code&gt;ï¼Œé€™ä»¶äº‹åœ¨ä»¥å¾€çš„ callback åšæ³•å°±æœƒæ˜¯&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-swift&quot; data-lang=&quot;swift&quot;&gt;&lt;span class=&quot;n&quot;&gt;myQueue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

&lt;span class=&quot;err&quot;&gt;â€‹&lt;/span&gt;    &lt;span class=&quot;nf&quot;&gt;doSomething&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;è€Œç¾åœ¨æˆ‘å€‘çš„ç›®æ¨™æ˜¯è¦èƒ½æ“æ§äº‹ä»¶çš„ç™¼ç”Ÿæ™‚é–“ï¼Œå°æ–¼é¦¬ä¸Šè¦åšçš„äº‹ä»¶æ™‚é–“ç‹€æ…‹åªæœ‰åšèˆ‡ä¸åšå…©ç¨®ï¼Œæ‰€ä»¥è§£æ³•å°±æ˜¯æ”¾å€‹ array å„²å­˜è¦æ’ç¨‹çš„å·¥ä½œï¼Œç„¶å¾Œæœ‰å€‹ method å¯ä»¥è§¸æ”¾æ‰€æœ‰å„²å­˜èµ·ä¾†ï¼Œæº–å‚™è¦ç™¼ç”Ÿçš„å·¥ä½œï¼ˆæ³¨æ„ä»¥ä¸‹å…ˆç•¥éäº†å…¶å®ƒå…©ç¨® scheduleï¼‰&lt;/p&gt;

&lt;p&gt;é¦–å…ˆæˆ‘å€‘éœ€è¦ä¸€å€‹ã€ŒåŒ…è£å·¥ä½œçš„å®¹å™¨ã€ï¼Œè€Œä¸”å®ƒå¿…é ˆæ˜¯å€‹ Disposable ï¼Œå› ç‚ºä½ å¯ä»¥ç™¼ç¾ schedule method æ˜¯å›ä¸€å€‹ Disposable&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-swift&quot; data-lang=&quot;swift&quot;&gt;&lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;VirtualSchedulerItem&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Disposable&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

  &lt;span class=&quot;c1&quot;&gt;// çœŸæ­£çš„éåŒæ­¥å·¥ä½œåœ¨æ­¤&lt;/span&gt;

  &lt;span class=&quot;kd&quot;&gt;typealias&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Action&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Disposable&lt;/span&gt;



  &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Action&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;disposable&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;SingleAssignmentDisposable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;isDisposed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Bool&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

&lt;span class=&quot;err&quot;&gt;â€‹&lt;/span&gt;    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;disposable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;isDisposed&lt;/span&gt;

  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;



  &lt;span class=&quot;nf&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;@escaping&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

&lt;span class=&quot;err&quot;&gt;â€‹&lt;/span&gt;    &lt;span class=&quot;k&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;action&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;action&lt;/span&gt;

  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;c1&quot;&gt;// çœŸæ­£åŸ·è¡Œå·¥ä½œçš„è§¸ç™¼é»&lt;/span&gt;

  &lt;span class=&quot;kd&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;invoke&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

&lt;span class=&quot;err&quot;&gt;â€‹&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;disposable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;setDisposable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;

  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;



  &lt;span class=&quot;kd&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;dispose&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

&lt;span class=&quot;err&quot;&gt;â€‹&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;disposable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;dispose&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;æ¥ä¸‹ä¾†è¦ä¾†åšä¸€å€‹è‡ªå·±çš„ Schedulerï¼š&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-swift&quot; data-lang=&quot;swift&quot;&gt;&lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;MyTestScheudler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;SchedulerType&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

  &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;scheduleds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;VirtualSchedulerItem&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;

  &lt;span class=&quot;c1&quot;&gt;// RxTime å…¶å¯¦æ˜¯ Date çš„ typealias&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;now&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;RxTime&lt;/span&gt;



  &lt;span class=&quot;nf&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;now&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;RxTime&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;RxTime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

&lt;span class=&quot;err&quot;&gt;â€‹&lt;/span&gt;    &lt;span class=&quot;k&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;now&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;now&lt;/span&gt;

  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;



  &lt;span class=&quot;kd&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;schedule&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;StateType&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;StateType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;@escaping&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;StateType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Disposable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Disposable&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

&lt;span class=&quot;err&quot;&gt;â€‹&lt;/span&gt;    &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;compositeDisposable&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;CompositeDisposable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;err&quot;&gt;â€‹&lt;/span&gt;    &lt;span class=&quot;c1&quot;&gt;// æŠŠå·¥ä½œåŒ…åœ¨ scheduler item è£¡&lt;/span&gt;

&lt;span class=&quot;err&quot;&gt;â€‹&lt;/span&gt;    &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;item&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;VirtualSchedulerItem&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

&lt;span class=&quot;err&quot;&gt;â€‹&lt;/span&gt;      &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;err&quot;&gt;â€‹&lt;/span&gt;    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;err&quot;&gt;â€‹&lt;/span&gt;    

&lt;span class=&quot;err&quot;&gt;â€‹&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;scheduleds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;err&quot;&gt;â€‹&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;compositeDisposable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;insert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;err&quot;&gt;â€‹&lt;/span&gt;    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;compositeDisposable&lt;/span&gt;

  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;c1&quot;&gt;// çœŸæ­£åŸ·è¡Œæ‰€æœ‰ scheduled task &lt;/span&gt;

  &lt;span class=&quot;kd&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

&lt;span class=&quot;err&quot;&gt;â€‹&lt;/span&gt;    &lt;span class=&quot;c1&quot;&gt;// é€™è£¡å°±æŠŠæ‰€æœ‰å·¥ä½œéƒ½è®ŠæˆåŒæ­¥äº†&lt;/span&gt;

&lt;span class=&quot;err&quot;&gt;â€‹&lt;/span&gt;    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;item&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;scheduleds&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

&lt;span class=&quot;err&quot;&gt;â€‹&lt;/span&gt;      &lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;invoke&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;err&quot;&gt;â€‹&lt;/span&gt;    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;err&quot;&gt;â€‹&lt;/span&gt;    &lt;span class=&quot;n&quot;&gt;scheduleds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;removeAll&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// åšå®Œå°±å¯ä»¥ç§»é™¤äº†&lt;/span&gt;

  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;ä¿®æ”¹æˆ‘å€‘çš„ testï¼š&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-swift&quot; data-lang=&quot;swift&quot;&gt;&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;testScheduler&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;MyTestScheudler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;extension&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Dependency&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

  &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Dependency&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

&lt;span class=&quot;err&quot;&gt;â€‹&lt;/span&gt;    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Observable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;just&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;mock&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

  &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;scheduler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;testScheduler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;



&lt;span class=&quot;kd&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;testMockedRequest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;results&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]()&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;vm&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;ViewModel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;vm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;

&lt;span class=&quot;err&quot;&gt;â€‹&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;observeOn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;testScheduler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;err&quot;&gt;â€‹&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;subscribe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;onNext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

&lt;span class=&quot;err&quot;&gt;â€‹&lt;/span&gt;          &lt;span class=&quot;n&quot;&gt;results&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;err&quot;&gt;â€‹&lt;/span&gt;       

&lt;span class=&quot;err&quot;&gt;â€‹&lt;/span&gt;    &lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;

&lt;span class=&quot;err&quot;&gt;â€‹&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;disposed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;by&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

  &lt;span class=&quot;c1&quot;&gt;// ä»¥ä¸‹æ‰æœ‰è®ŠåŒ–&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;vm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;doRequest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

  &lt;span class=&quot;kt&quot;&gt;XCTAssertEqual&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;results&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[])&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// we can test the beginning&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;testScheduler&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

  &lt;span class=&quot;kt&quot;&gt;XCTAssertEqual&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;results&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;mock&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;è·‘ä¸€ä¸‹æ¸¬è©¦ç§’éï¼Œé›–ç„¶æ˜¯å€‹ç°¡å–®çš„ä¾‹å­ï¼Œä½†ä¸ç”¨ç­‰ expectation å°±æ˜¯çˆ½å•¦ï¼ä¸‹é›†å°‡ä»‹ç´¹å¦‚æœäº‹æƒ…æ²’æœ‰è¦é¦¬ä¸Šç™¼ç”Ÿçš„æƒ…æ³ï¼Œä»¥åŠè‹¥å¸Œæœ›äº‹ä»¶è§¸ç™¼ä¹Ÿèƒ½æŒ‡å®šç™¼ç”Ÿåœ¨æ™‚é–“è»¸ä¸Šçš„æŸä¸€å€‹é»è©²å¦‚ä½•é€²è¡Œã€‚&lt;/p&gt;</content><author><name>Pofat</name></author><category term="RxSwift" /><category term="Swift" /><summary type="html">Functional Reactive Programming é¡¯ç„¶æ˜¯é€™äº›å¹´çš„é–‹ç™¼æ¨¡å¼é¡¯å­¸ä¹‹ä¸€ï¼Œå°¤å…¶æ˜¯ Apple ä¹Ÿæ¨å‡ºäº†è‡ªå·±çš„æ–¹æ¡ˆ - Combineï¼Œç”±æ­¤å¯è¦‹å…¶é‡è¦æ€§ã€‚åŸºæœ¬ä¸Š Reactive Programming æ˜¯å°‡éåŒæ­¥çš„äº‹ä»¶ï¼ŒåŠ ä¸Šæ™‚é–“é€™å€‹ç¶­åº¦ï¼Œä»¥è®Šæˆä¸€å€‹é¢å‘è³‡æ–™ä¸²æµçš„é–‹ç™¼å…¸ç¯„ï¼Œè€Œé€™å€‹ç™¼å°„äº‹ä»¶çš„ä¸»é«”ï¼Œåœ¨ä¸åŒçš„ FRP æ¡†æ¶å„ç”±ä¸åŒè§’è‰²æ“”ç•¶ï¼Œ ReactiveCocoa æ˜¯ Signalï¼ŒRxSwift æ˜¯ Observableï¼ŒCombine å°±æ˜¯ Publisherï¼Œä»Šå¤©çš„ä¸»è§’æœƒæ˜¯ RxSwiftï¼Œä¸é Combine èˆ‡å®ƒçš„æ¦‚å¿µå¹¾ä¹éƒ½æ˜¯ç›¸é€šçš„ï¼Œç‰©ä»¶é–“çš„å°æ‡‰é—œä¿‚ä¹Ÿå¹¾ä¹æ˜¯ 1:1ï¼Œ æ‰€ä»¥åŒæ¨£çš„æ¦‚å¿µä¹Ÿå®Œå…¨é©ç”¨ã€‚</summary></entry><entry><title type="html">å‰æ‰€æœªæœ‰çš„å„ªç§€éŠæˆ²ä½œå“ - æœ€å¾Œç”Ÿé‚„è€…</title><link href="http://localhost:4000/2020/06/19/The-Best-Product-As-A-Game.html" rel="alternate" type="text/html" title="å‰æ‰€æœªæœ‰çš„å„ªç§€éŠæˆ²ä½œå“ - æœ€å¾Œç”Ÿé‚„è€…" /><published>2020-06-19T00:00:00+08:00</published><updated>2020-06-19T00:00:00+08:00</updated><id>http://localhost:4000/2020/06/19/The-Best-Product-As-A-Game</id><content type="html" xml:base="http://localhost:4000/2020/06/19/The-Best-Product-As-A-Game.html">&lt;p&gt;å¦‚æœè¦å•æˆ‘èªç‚ºæœ€æ£’æœ€å„ªç§€çš„å–®æ©ŸéŠæˆ²ï¼Œæˆ‘ä¸€å®šæ¯«ä¸çŒ¶è±«åœ°èªªå‡ºã€Œæœ€å¾Œç”Ÿé‚„è€…ã€ï¼Œæ²’æœ‰ä¹‹ä¸€ã€‚&lt;/p&gt;

&lt;p&gt;Â  Â  Â  Â å› ç‚ºæˆ‘å¾ä¾†æ²’æœ‰ç©éé€™æ¨£çš„éŠæˆ²ï¼Œå–®å¾éŠæˆ²çš„éŠç©æ€§ä¸Šä¾†çœ‹ï¼Œå®ƒç¨±å¾—ä¸Šéå¸¸å„ªç§€ä½†é‚„ä¸åˆ°ç¥ï¼Œåªæ˜¯å®ƒéŠç©æ–¹å¼ã€ç´°ç¯€ã€äº’å‹•çš„è¨­è¨ˆï¼Œç„¡ä¸€ä¸æ˜¯åœ¨ç‚ºæœ€å¾Œçµå±€ä¸€å±¤ä¸€å±¤åœ°é‹ªé™³å¼µåŠ›ï¼Œé€éè¦ªèº«éŠç©é«”é©—æ•´æ®µéŠæˆ²ï¼Œè®“çµå°¾é‚£ä¸€å¹•å°è©±åˆ°ä¾†æ™‚ï¼Œé«˜æ½®å’Œç©ç´¯çš„å¼µåŠ›ä¸€å£æ°£å…¨éƒ¨é‡‹æ”¾ï¼Œç„¶å¾Œåˆç¬é–“æˆ›ç„¶è€Œæ­¢ï¼Œç”±å¥§æ–¯å¡çå¾—ä¸»çš„é…æ¨‚å®¶ Guatavo Santollala æ’°å¯«çš„ &lt;a href=&quot;https://www.youtube.com/watch?v=3o_RwQysgA8&quot;&gt;The Path (A New Begining)&lt;/a&gt; æ‚ ç„¶éŸ¿èµ·ï¼Œç•™çµ¦ç©å®¶ç„¡æ¯”çš„æ‡¸å¿µå’Œå›å‘³ã€‚&lt;/p&gt;

&lt;p&gt;Â  Â  Â  Â ç•¶æ™‚ä¸€ç ´é—œæˆ‘å°±æ±ºå®šä¸€è¦ç‚ºå®ƒå¯«ä¸€ç¯‡æˆ‘çš„å¿ƒå¾—ï¼Œæœ€å¾Œç”Ÿé‚„è€…çœŸçš„æ˜¯å¤ªæ£’å¤ªæ£’çš„éŠæˆ²ä½œå“ï¼Œå› ç‚ºéŠç©æ™‚é–“æ¯”è§€å½±æ›´é•·ï¼Œåˆæœ‰å¯ä»¥è‡ªå·±æ“æ§çš„äº’å‹•ï¼Œæƒ…æ„Ÿæ²‰æµ¸å’Œå…¥æˆ²çš„éç¨‹å¯ä»¥æ¯”é›»å½±æ›´ç´°è†©ï¼Œæ¯”æ–‡å­—å°èªªæ›´ç‚ºç«‹é«”ï¼Œæˆ‘å¾æ²’æœ‰æƒ³éï¼ŒåŸä¾†èªªæ•…äº‹å¯ä»¥èªªåˆ°é€™ç¨®å¢ƒç•Œã€‚&lt;/p&gt;

&lt;p&gt;Â  Â  Â  Â åªæ˜¯ç•¶åˆæƒ³å¯«å¿ƒå¾—æ™‚äºŒä»£é‚„æ²’æ¶ˆæ²’æ¯ï¼Œå¾Œä¾†äºŒä»£ç¶“æ­·éå„ç¨®é¢¨é›¨éƒ½è¦ç™¼å”®äº†ï¼Œå°±æ”¹æˆæƒ³èªªäºŒä»£ç™¼å”®å‰ä¸€å®šè¦å¯«å‡ºä¾†ï¼Œçµæœé‚„æ˜¯é²äº†ï¼ˆå¯«åˆ°é€™æ®µæ™‚æ­£å¥½æ˜¯å°ç£æ™‚é–“ TLOU Part II å¯ä»¥é–‹å§‹éŠç©çš„æ™‚é–“é»ï¼‰ã€‚å¦å¤–ï¼Œæ—¢ç„¶æ˜¯æˆ‘å€‹äººçš„å¿ƒå¾—ï¼Œä»¥ä¸‹å…§å®¹æœƒå®Œå®Œå…¨å…¨åœ°å¤§æš´é›·éŠæˆ²åŠ‡æƒ…ï¼Œå¦‚æœæ²’ç©éæƒ³è¦ªè‡ªé«”é©—çš„æœ‹å‹å°±åˆ°æ­¤è€Œæ­¢ï¼Œç©å®Œå¾Œå†å›ä¾†çœ‹å§ï¼&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/UfnyYey.jpg&quot; alt=&quot;the last of us&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Â  Â  Â  Â å…ˆæä¸€äº›ç¼ºé»ï¼Œå†ä¾†ä¸€ä¸€èªªæ˜ç‚ºä½•æ­¤éŠæˆ²æˆ‘è¦–ç‚ºç¥ä½œï¼Œé¦–å…ˆé€™å€‹éŠæˆ²èƒŒæ™¯è¨­å®šä¸¦ä¸æ–°ç©ï¼Œæœ«æ—¥åƒµå±å•Ÿç¤ºéŒ„ï¼Œå¥³ä¸»è§’ Ellie æ˜¯å”¯ä¸€å…ç–«ï¼Œå¯èƒ½æˆç‚ºå…¨äººé¡æ•‘æ˜Ÿçš„äººã€‚åƒµå±çš„ä¾†æºå€’æœ‰é»æœ‰è¶£ï¼Œéˆæ„Ÿä¾†è‡ªæ–¼ä¸€ç¨®æœƒå¯„ç”Ÿè¸ç‰›æˆ–æ˜†èŸ²çš„çœŸèŒï¼Œå› æ­¤æœ‰äº†è®“å®ƒæœƒæ„ŸæŸ“ï¼ˆå¯„ç”Ÿï¼‰äººé¡çš„æƒ³æ³•ï¼Œå³ç‚ºéŠæˆ²ä¸­æ‰€ç¨±çš„ã€ŒèŸ²è‰èŒã€ï¼Œç„¶å¾ŒéŠæˆ²ç‚ºå–®çµå±€ä¹Ÿéé–‹æ”¾ä¸–ç•Œï¼Œæœ‰äº›äººå¯èƒ½æœƒå› æ­¤æ¸›å°‘èˆˆè‡´ä¸éé€™äº›éƒ½æ˜¯æˆ‘çš„æ„›ã€‚&lt;/p&gt;

&lt;p&gt;è‡³æ–¼é€™éŠæˆ²æˆ‘ä¸€ç›´èªªæ˜¯æœ€å„ªç§€çš„éŠæˆ²ä½œå“ï¼Œä¸»è¦é‚„æ˜¯æˆ‘èªç‚ºä»–æœ€é«˜çš„æˆå°±æ˜¯åœ¨ã€Œä»¥éŠæˆ²çš„å½¢å¼ï¼Œèªªäº†ä¸€å€‹ç²¾å½©çµ•å€«çš„æ•…äº‹ã€ã€‚&lt;/p&gt;

&lt;p&gt;ç¬¬ä¸€æ•´å€‹éŠæˆ²æ©«è·¨å››å­£ï¼Œä»¥å†¬å­£ç‚ºä¸­å¿ƒé»ï¼Œå†¬å­£å‰å’Œå†¬å­£å¾Œæ“æœ‰é«˜åº¦å°ç¨±çš„åŠ‡æƒ…ç™¼å±•ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;éŠæˆ²ä»¥ Joel çš„å¥³å…’ Sarah çš„è‡‰éƒ¨ç‰¹å¯«å’Œä»¥å¥¹çš„è¦–è§’åšç‚ºé–‹å§‹ï¼ŒéŠæˆ²æœ€çµ‚æ®µæ˜¯æ“ä½œ Ellie ä¸¦ä»¥å¥¹çš„è‡‰éƒ¨ç‰¹å¯«åšç‚ºçµæŸã€‚&lt;/li&gt;
  &lt;li&gt;è½‰æ›è¦–è§’å¾Œ Joel æŠ±è‘— Sarah é€ƒé›£ï¼Œé‡åˆ°äº†æŒæ§çš„å£«å…µï¼Œç„¶å¾Œå¤±å»äº†ä¸€å€‹å¥³å…’ï¼Œè€Œæœ«æ®µå‰çš„é†«é™¢æˆ°ï¼ŒJoel æŠ±è‘— Ellie é€ƒé›£ï¼Œé‡åˆ°äº†æŒæ§çš„ Marleneï¼Œæœ€çµ‚ä¿è­·äº† Ellieï¼Œå¾—åˆ°äº†ä¸€å€‹å¥³å…’ã€‚&lt;/li&gt;
  &lt;li&gt;è€Œ Joel æœƒé‡åˆ° Ellie å‰‡æ˜¯ä¸€é–‹å§‹é‡åˆ° Marlene å¾Œå°‡ Ellie å¸¶é›¢ FireFly åŸºåœ°ï¼Œæœ€çµ‚åˆå°‡ Ellie å¸¶å› FireFly ç¸½éƒ¨ï¼ŒMarlene çš„æ‰‹ä¸­ã€‚&lt;/li&gt;
  &lt;li&gt;ä¸€é–‹å§‹ Joel å«Œ Ellie å¾ˆåµç¸½æ˜¯ä¸é¡˜å¤šè©±åªåšå¿…è¦çš„äº‹ï¼ŒEllie å»æ¥µåº¦åœ°æƒ³è¦è¡¨ç¾è‡ªæˆ‘å’Œå°‹æ±‚ Joel çš„æ³¨æ„ï¼Œç„¶è€Œå¾Œä¾† Ellie åœ¨ç¶“æ­·è¨±å¤šå¾Œåæ€é€™ä¸€åˆ‡è€Œé™·å…¥æ²‰é»˜ï¼Œé‚£æ™‚çš„ Joel å·²ç¶“æ˜¯ç„¡æ³•å¿½è¦– Ellie çš„ç•°æ¨£èˆ‡æ„Ÿå—è€Œä¸»å‹•åœ°é—œå¿ƒå¥¹äº†ã€‚&lt;/li&gt;
  &lt;li&gt;Joel ä¸€åº¦æƒ³é›¢é–‹ Ellieï¼Œæœ€å¾Œæ˜¯ Ellie å’Œå¥¹äº’ç›¸å¦ç™½æŠŠ Joel æ‰¾äº†å›ä¾†ç¹¼çºŒæ—…è¡Œï¼Œåœ¨ Joel è·Œå‚·å¾Œ Ellie é›¢é–‹äº† Joel å»æ‰¾è—¥å’Œé£Ÿç‰©ï¼Œè¢«æ‰èµ°å¾Œæ˜¯ Joel æŠŠå¥¹æ‰¾äº†å›ä¾†äº†ã€‚&lt;a href=&quot;https://www.youtube.com/watch?v=51Xs6sZGq3o&quot;&gt;å…©äººå¦ç™½çš„å½±ç‰‡ç‰‡æ®µ&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Â  Â  Â  Â å› é«˜åº¦å°ç¨±çš„é—œä¿‚ï¼Œè¶Šåˆ°å¾ŒæœŸä½ æœƒè¦ºå¾—é€™äº›å ´æ™¯éƒ½æœ‰ deja vu çš„æ„Ÿè¦ºï¼Œä½†å¿ƒå¢ƒå·²å¤§ä¸åŒï¼Œè¶Šä¾†è¶Šå¿ƒç¹« Ellie ï¼Œæœ€å¾ŒæŠ±è‘— Ellie é€ƒè·‘çš„æ™‚å€™ï¼Œæˆ‘å…§å¿ƒå®Œå…¨è‡ªå‹•æŠŠæœ€åˆé€ƒè·‘çš„é‚£ä¸€å¹•é‡ç–Šï¼Œå…§å¿ƒä¹Ÿç„¡æ¯”ç„¦æ…®ï¼Œç¦ä¸ä½åœ°è·Ÿè‘— Joel å¤§å–Šï¼šã€Œé€™ä¸€æ¬¡ã€é€™ä¸€æ¬¡æˆ‘çµ•å°æœƒæŠŠå¦³ä¿è­·å¥½ï¼ã€&lt;/p&gt;

&lt;p&gt;Â  Â  Â  Â æ­¤å¤–ï¼ŒéŠæˆ²ä¸­å„å€‹å‡ºç¾çš„ NPC çµ•éæ‰“é†¬æ²¹ï¼Œè€Œæ˜¯ä¸€æ®µåˆä¸€æ®µåœ°çš„æƒ…æ„Ÿå‚¬åŒ–åŠ‘ï¼Œè®“ Joel å’Œ Ellie å…©äººçš„é—œä¿‚åœ¨æ—…é€”ä¸­ä¸åœåœ°è®ŠåŒ–ï¼Œæ¯”å¦‚ Tess çš„è‡ªæˆ‘çŠ§ç‰²ï¼ˆåŠ æ·± Ellie å­æƒ¡è‡ªæˆ‘çš„ç½ªæƒ¡æ„Ÿï¼‰ï¼Œ Bill ä¸€å€‹ç¥ç¶“å…®å…®çš„ç«çˆ†å¤§å”ï¼Œåœ¨å¹«å¿™ Joel é€™ä»»å‹™çš„çµ‚é»ï¼Œæ˜¯ç›®ç¹è‡ªå·±çš„åŒæ€§æ„›äººä¸ŠåŠè‡ªæ®ºçš„å±é«”ã€‚&lt;/p&gt;

&lt;p&gt;Â  Â  Â  Â è€Œä¸€é–‹å§‹é—œä¿‚ç·Šå¼µè²Œä¼¼æ•µäººçš„é»‘äººå…„å¼Ÿ Henry å’Œ Samï¼Œåˆè¦‹é¢æ™‚åŠæ‹”å¼©å¼µï¼Œæœ€å¾Œåœ¨ä¸€åŒè¿å‘ä¸€æ¬¡åˆä¸€æ¬¡çš„çµ•æœ›å¾Œï¼Œäº’ç›¸èªå¯ä¸¦æˆç‚ºå¥½å‹ï¼Œåœ¨ Joel èˆ‡ Ellie çš„å¿ƒä¸­å·²ä½”æ“šäº†ä¸€å¸­ä¹‹åœ°ï¼ŒåŸä¾†åœ¨æ®˜å¿é†œé™‹çš„æœ«ä¸–ï¼Œé‚„å¯ä»¥é‡åˆ°èƒ½äº¤å¿ƒä¹‹äººï¼Œè€Œé€™æ¨£ç¾å¥½çš„æ„‰å¿«å¤œæ™šå»è¢«æ®˜å¿æš´æˆ¾çš„æ—©æ™¨å†æ¬¡å°‡ä»–å€‘æ¨å‘å¦ä¸€å€‹çµ•æœ›çš„æ·±æ·µã€‚&lt;a href=&quot;https://www.youtube.com/watch?v=2GjhDMwudKY&quot;&gt;å½±ç‰‡ç‰‡æ®µ&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Â  Â  Â  Â ç¶“æ­·éç„¡æ•¸çš„çµ•æœ›ï¼Œçœ‹åˆ°ä¸€æ¬¡æ¯”ä¸€æ¬¡é†œé™‹çš„äººæ€§ï¼ŒEllie é™¤äº†Joel ä»¥å¤–æ—©å·²ä¸ç›¸ä¿¡ä»–äººï¼Œé€™ä¹Ÿæ˜¯ç‚ºä½•åœ¨ Joel é‡å‚·å¾Œ Ellie é¦–æ¬¡é‡åˆ°é£Ÿäººé­” David æ™‚ï¼Œç¸±ä½¿ David ç™¾èˆ¬å‹å–„åœ°é‡‹å‡ºå–„æ„ï¼ŒEllie ç„¡è«–å¦‚ä½•éƒ½ä¸é¡˜ç›¸ä¿¡ä»–ï¼Œæœ€çµ‚åˆ¶è£ David æ™‚ Ellie å®³æ€•é©šæ…Œï¼Œå·²ç„¶å®Œå…¨å¤±æ§è€Œ Joel è¡éä¾†ä¸€æŠŠæŠ±ä½å¥¹ï¼Œä¸æ¨åœ°æŠ±ç·Šå¥¹ä¸¦è„«å£è€Œå‡ºï¼šã€Œ oh, baby girlã€ï¼Œå°æ¯”ä¸€é–‹å§‹å«Œéº»ç…©ä¸æƒ³æ¥ä¸‹ Ellie é€™ã€Œä»»å‹™ã€çš„ Joelï¼ŒEllie åœ¨å¥¹å¿ƒä¸­å·²ç¶“æ˜¯ç„¡å¯å–ä»£çš„ç¬¬äºŒå€‹å¥³å…’ã€‚&lt;a href=&quot;https://www.youtube.com/watch?v=NWfoMG3JHf4&quot;&gt;å½±ç‰‡ç‰‡æ®µ&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Â  Â  Â  Â éŠæˆ²ä¸­é‚„æœ‰å„ç¨®éŠç©æ™‚çš„ç´°ç¯€ï¼Œä¸åœåœ°åœ¨ç‚ºè½‰æŠ˜é»ç™¼ç”Ÿæ™‚çš„æƒ…æ„ŸåŠ æº«ï¼Œæ¯”å¦‚ä¸€é–‹å§‹æ‰¾åˆ°å¯æ”¶é›†å…ƒç´ çš„æ¼«ç•«æœ¬æ™‚ï¼Œ Ellie è·Ÿ Joel è§£é‡‹ä»–é‚„ä¸€è‡‰ã€Œå–”ï¼Œæ˜¯å–”ã€ï¼Œåˆ°å¾ŒæœŸæ¢ç´¢æ™‚åœ¨ä¸€äº›è§’è½æ‰¾åˆ°äº†æ¼«ç•«æœ¬ï¼ŒJoel é€æ¼¸è®Šæˆã€ŒEllie çœ‹åˆ°äº†ä¸€å®šæœƒå¾ˆé–‹å¿ƒã€ï¼Œç•¶ä¸‹è‡‰ä¸Šä¹Ÿæœƒä¸è‡ªè¦ºåœ°æ›è‘—å’Œ Joel ä¸€æ¨£çš„å¾®ç¬‘ã€‚å’Œé»‘äººå¼Ÿå¼Ÿ Sam é€ƒé›£ç¶“éå¹¼å…’åœ’æ™‚ï¼ŒSam çœ‹åˆ°ä¸€å€‹æ©Ÿå™¨äººç©å…·éå¸¸æƒ³è¦æ’¿èµ°ï¼Œå…¶å…„ Henry ç”¨ã€Œåªèƒ½å¸¶ä¸€å®šè¦ç”¨åˆ°çš„æ±è¥¿ã€ç‚ºç”±é˜»æ­¢äº†ä»–ï¼Œç›®æ“Šé€™å¹•çš„ Ellie æœƒåœ¨å¹¼å…’åœ’æ±å¼µè¥¿æœ›ä¸èµ°ï¼Œä½†ä¸€æ—¦ä½ è¦–ç·šè½‰åˆ° Ellie ä¸åœ¨çš„åœ°æ–¹ï¼Œå¥¹å°±æœƒå·å·åœ°æŠŠç©å…·æ’¿èµ·ä¾†ï¼Œè€Œä¸”ä½ å¯ä»¥ç”¨éŠæˆ²è£¡è½è²è¾¨ä½çš„èƒ½åŠ›æ¸…æ¥šåœ°ã€Œè½ã€åˆ° Ellie å½è…°æŠŠç©å…·æ’¿èµ·ä¾†å¡é€²èƒŒåŒ…çš„å‹•ä½œï¼å¦‚æœåœåœ¨è·¯ä¸Šä¸å‹•æ™‚ Ellie ä¹Ÿæœƒç™¼å‡ºå„ç¨®ç‰¢é¨·ï¼Œä¸€èµ·è¡Œå‹•æ™‚ä¹Ÿæœƒä¸åœåœ°èŠå¤©ï¼Œæ­£æ˜¯é€™äº›æ¯«ä¸é¦¬è™çš„å°ç´°ç¯€ï¼Œä¸€ç›´è®“ä½ èƒ½å¤ å¾ˆç´°ç·»åœ°å»æ„Ÿå—é€™äº›äººç‰©ä¹‹é–“çš„æƒ…æ„Ÿèˆ‡æƒ…ç·’ã€‚&lt;/p&gt;

&lt;p&gt;Â  Â  Â  Â é™¤äº†é«˜åº¦å°ç¨±å¤–ï¼Œæœ€å¾Œç”Ÿé‚„è€…çš„éŠæˆ²å…§å®¹ä¸­ä¹Ÿå……æ»¿äº†ã€Œå°æ¯”ã€ï¼Œæ¯”å¦‚ Henry è‡³å§‹è‡³çµ‚å› æ“”å¿ƒå¼Ÿå¼Ÿ Sam æœƒå‡ºäº‹åœ¨é€ƒé›£ä¸­å®Œå…¨ä¸é¡˜æ”¾æ‰‹è®“ä»–å»é¢å°å±éšªæˆ–å¹«å¿™ï¼Œæœ€çµ‚å…©äººç„¡æ³•å­˜æ´»ï¼›Joel ä¸€é–‹å§‹ä¹Ÿæ˜¯å° Ellie æŠ±æŒè‘—ç›¸ä¼¼çš„æ…‹åº¦ï¼Œä½†å¾Œä¾†éš¨è‘—é—œä¿‚é€²å±•ï¼Œä»–ä¹Ÿé«”èªåˆ°å¦‚æœä¸é©åº¦åœ°æ”¾æ‰‹è®“å¥¹ä¸€èµ·å¹«å¿™ï¼Œå…©å€‹äººéƒ½æœƒç„¡æ³•å­˜æ´»ä¸‹ä¾†ï¼Œå› æ­¤å¯ä»¥çœ‹åˆ°æœ€å¾Œå…©å€‹äººåœ¨æˆ°é¬¥ä¸­åˆä½œç„¡é–“ï¼Œåº¦éäº†ä¸€é—œåˆä¸€é—œçš„é›£é—œã€‚&lt;/p&gt;

&lt;p&gt;Â  Â  Â  Â é›–ç„¶ç¶“æ­·éé€™éº¼å¤šäº‹ï¼Œä½† Ellie ä»ç„¶å—åˆ°é€™äº›å¤±å»ç”Ÿå‘½çš„è¦ªè¿‘ä¹‹äººæ‰€æŠ˜ç£¨è‘—ï¼šç‚ºä»€éº¼æ˜¯æˆ‘ï¼Ÿç‚ºä»€éº¼ä¸æ˜¯æˆ‘ï¼Ÿé€™æ¨£çš„æªçµåœ¨é‡è¦‹é•·é ¸é¹¿å¾Œè¢«å¥¹è½‰åŒ–ç‚ºæ±ºå¿ƒï¼Œæ±ºå®šå®Œæˆè‡ªå·±çš„ä½¿å‘½ - æˆç‚ºå…¨äººé¡çš„ç–«è‹—ï¼Œä½†æ˜¯ Joel å»é€€å´äº†ï¼šã€Œä½ çŸ¥é“çš„å§ï¼Ÿæˆ‘å€‘ä¹Ÿå¯ä»¥ä¸€èµ·å›åˆ° Jackson Cityï¼Œå’Œ Tommy ä¸€èµ·éç”Ÿæ´»ï¼Œç®¡ä»–ä»€éº¼ç–«è‹—ï¼Ÿã€ä½†æ˜¯è‹¥å°±é€™æ¨£æ­¸å»ï¼ŒEllie èªç‚ºç„¡æ³•çµ¦é‚£äº›åœ¨å¥¹èº«é‚Šå¤±å»ç”Ÿå‘½çš„äººä¸€å€‹äº¤ä»£ï¼Œå› æ­¤ä¾¿æ±ºå®šä¸€å®šè¦èµ°åˆ°ç›¡é ­ã€‚&lt;a href=&quot;https://www.youtube.com/watch?v=znRz8sp61gU&quot;&gt;å½±ç‰‡ç‰‡æ®µ&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Â  Â  Â  Â ç„¶è€Œç©äº†é€™éº¼å¤šå°æ™‚åˆ°é”æœ€çµ‚çš„ FireFly ç¸½éƒ¨ï¼Œåœ¨ Joel å¾—çŸ¥ç–«è‹—çš„ä»£åƒ¹æ˜¯ Ellie çš„å‘½æ™‚å¤§é–‹æ®ºæˆ’ï¼Œç¥æ“‹æ®ºç¥ï¼Œä½›æ“‹æ®ºä½›ï¼Œåªç‚ºäº†æ•‘å‡º Ellieï¼Œåˆæˆ–è€…èªªï¼Œæ•‘å‡ºç•¶å¹´å¥¹æ²’æ•‘åˆ°çš„ Sarahï¼Œæœ€å¾Œå¿«é€ƒå‡ºæ™‚å’Œ Marlene æœ‰ä¸€æ®µå¾ˆæœ‰æ„æ€çš„å°è©±ï¼ŒMarlene èªªé“ï¼šã€Œä½ æ•‘ä¸äº†å¥¹çš„ï¼Œå°±ç®—é€ƒå‡ºé€™è£¡åˆæ€æ¨£ï¼Œä¸æ˜¯è¢« clickers æ’•ç¢å°±æ˜¯è¢«äººé¡å§¦æ®ºï¼ã€Joel å›é“ï¼šã€ŒThat ainâ€™t for you to decide.ã€Marlene èªªï¼šã€Œé€™æ˜¯å¥¹æƒ³è¦åšçš„äº‹ï¼Œä½ çŸ¥é“çš„ï¼ã€è€Œ Joel ä¹Ÿçš„ç¢ºçŸ¥é“ï¼Œä½†æœ€å¾Œåœ¨å…¨äººé¡å­˜äº¡å’Œå¥³å…’ä¹‹é–“ï¼ŒJoel é¸æ“‡äº†å¥³å…’ï¼Œé€™é¸æ“‡ä¸å®Œç¾ã€è‡ªç§ï¼Œä½†å»å……æ»¿äººå‘³ï¼Œé€™å°±æ˜¯æœ€å¾Œç”Ÿé‚„è€…çš„é­…åŠ›æ‰€åœ¨ã€‚&lt;/p&gt;

&lt;p&gt;Â  Â  Â  Â æœ€å¾Œé‚£æœ€æœ€æœ€æœ€æœ€æ£’åˆæœ€é›£å¿˜çš„ï¼Œä»¥è¬Šè¨€åšç‚ºçµå°¾çš„çµå±€ï¼Œæˆ‘å¯¦åœ¨ç„¡æ³•ç”¨è¨€èªå½¢å®¹å®ƒæœ‰å¤šæ£’ï¼Œç•¶ Ellie å³å°‡å’Œ Joel å›åˆ° Jackson City æ™‚ï¼Œå¥¹å‘ Joel èªªå‡ºè‡ªå·±ç‚ºä½•åŸ·æ„è¦èµ°åˆ°æ—…ç¨‹ç›®çš„åœ°çš„æƒ³æ³•ï¼Œå¥¹éœ€è¦è­‰æ˜å¥¹çš„ç”Ÿå­˜åƒ¹å€¼ï¼Œè€Œ Joel ä»¥ä¸€å€‹ç”Ÿå­˜è€…éä¾†äººçš„èº«åˆ†å‘Šè¨´å¥¹ï¼Œç¸½æœ‰ä¸€å¤©å¥¹æœƒå†æ‰¾åˆ°å¥¹çš„ç”Ÿå­˜ç›®æ¨™ï¼ˆåŒæ™‚æ‰‹æ‘¸äº†ä¸€ä¸‹ç•¶å¹´ Sarah é€çµ¦ä»–åšç‚ºç”Ÿæ—¥ç¦®ç‰©ï¼Œæ—©å·²ä¸å†èµ°å‹•çš„æ‰‹è¡¨ï¼‰ï¼Œè€Œ Ellie è‡ªæˆ‘çˆ­æ‰åˆ°é”é ‚é»æ™‚èªªå‡ºçš„è©±æˆ‘æ°¸é éƒ½èƒ½èƒŒå¾—å‡ºä¾†ï¼š&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Swear to me, swear to me that everything you said about the FireFly is true.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;è€Œ Joel èªªäº†è¬Šã€‚&lt;/p&gt;

&lt;p&gt;Â  Â  Â  Â æœ€å¾Œ Ellie é‚£é›™å’•åš•è½‰å‹•çš„é›™çœ¼ä¸‹çš„åƒçµ²è¬ç·’ï¼Œåªæœ‰å®Œæ•´ç¶“æ­·ééŠæˆ²çš„äººæ‰æœ‰å¯èƒ½äº†è§£å¥¹åœ¨èªªå‡ºã€ŒOkayã€æ™‚å…§å¿ƒçš„çœŸæ­£æƒ³æ³•ï¼Œç¬¬ä¸€æ¬¡åœ¨éŠæˆ²ä¸­ï¼Œæˆ‘äº†è§£åˆ°ä½•è¬‚è¡¨æ¼”å’Œç§‘æŠ€çµåˆçš„è—è¡“ï¼Œé€™è£¡çš„è¡¨æƒ…æ•æ‰éå¸¸çœŸå¯¦ç´°è†©ï¼Œé€™ä¹Ÿæ˜¯ç‚ºä½•æˆ‘å¦‚æ­¤æ¨å´‡æœ€å¾Œç”Ÿé‚„è€…çš„åŸå› ã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.youtube.com/watch?v=RklOBIA6K5E&quot;&gt;æœ€çµ‚çµå±€å½±ç‰‡ç‰‡æ®µ&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Â  Â  Â  Â æœ€å¾Œæˆ‘è¦æä¸€ä¸‹é£¾æ¼” Ellie çš„æ¼”å“¡ï¼ŒAshley Johnson æ˜¯æˆ‘å¾ˆå–œæ­¡çš„æ¼”å“¡ä¹‹ä¸€ï¼Œé›–ç„¶å¥¹ä¸æ˜¯å¥½èŠå¡¢ä¸€ç·šå½±æ˜Ÿï¼Œä½†æˆ‘å°±æ˜¯å¾ˆå–œæ­¡å¥¹çš„æ°£è³ªå’Œæ¼”æˆ²çš„æ¨£å­ï¼Œæœ€å¾Œç”Ÿé‚„è€…éŠæˆ²ç¸½ç›£ Neil Druckmann æœ‰åœ¨æ¨ç‰¹ç™¼äº†ä¸€ç¯‡ç•¶æ™‚ä»–å€‘æ‹å®Œæœ€æœ‰é‡å¿ƒçš„ä¸€å¹•çš„&lt;a href=&quot;https://twitter.com/neil_druckmann/status/1119026754952151040&quot;&gt;ç…§ç‰‡&lt;/a&gt;ï¼ŒAshley å’Œ Troy (Joel çš„æ¼”å“¡) ä¹‹é–“ä¹Ÿå¤ªæœ‰æ„›äº†å§ï¼Œæˆ‘ä¹…ä¹…ç„¡æ³•å¿˜æ‡·ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/Gs47boh.jpg&quot; alt=&quot;Ashely And Tryo&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Â  Â  Â  Â æ€éº¼æœƒæœ‰é€™éº¼æ£’çš„éŠæˆ²å•¦ï¼æˆ‘çµ‚æ–¼æŠŠå…§å¿ƒçš„æƒ³æ³•éƒ½ä¸€åç‚ºå¿«äº†ï¼Œå¯ä»¥å®‰å¿ƒåœ°æº–å‚™ä¾†æ‰“äºŒä»£äº†å§ï¼ï¼ï¼æœ€å¾Œç”Ÿé‚„è€…æ˜¯å€‹é—œæ–¼æ„›çš„æ•…äº‹ï¼Œè€ŒäºŒä»£æ˜¯å€‹é—œæ–¼ä»‡æ¨çš„æ•…äº‹ï¼Œç„¡è«–å¦‚ä½•ï¼Œæˆ‘éƒ½ç›¸ä¿¡ Naughty Dog æœƒå†æ¬¡åœ°èªªå‡ºä¸€å€‹è¶…æ£’çš„æ•…äº‹ã€‚&lt;/p&gt;

&lt;p&gt;p.s. æœ¬æ–‡å¼•ç”¨ä¹‹åœ–ç‰‡çš†ç‚º Naughty Dog æ‰€æ“æœ‰ã€‚&lt;/p&gt;</content><author><name>Pofat</name></author><category term="Game" /><category term="TLOU" /><summary type="html">å¦‚æœè¦å•æˆ‘èªç‚ºæœ€æ£’æœ€å„ªç§€çš„å–®æ©ŸéŠæˆ²ï¼Œæˆ‘ä¸€å®šæ¯«ä¸çŒ¶è±«åœ°èªªå‡ºã€Œæœ€å¾Œç”Ÿé‚„è€…ã€ï¼Œæ²’æœ‰ä¹‹ä¸€ã€‚</summary></entry><entry><title type="html">Opaque Result Type</title><link href="http://localhost:4000/2019/08/05/Opaque-Result-Type.html" rel="alternate" type="text/html" title="Opaque Result Type" /><published>2019-08-05T00:00:00+08:00</published><updated>2019-08-05T00:00:00+08:00</updated><id>http://localhost:4000/2019/08/05/Opaque-Result-Type</id><content type="html" xml:base="http://localhost:4000/2019/08/05/Opaque-Result-Type.html">&lt;p&gt;ä¸Šæ¬¡å¯«å®Œ PAT (Protcol with Assocaited Type) ä¸èƒ½åšç‚ºå‹åˆ¥çš„å¦ä¸€ç¨®è§£æ³•æ²’å¤šä¹…ï¼ˆè«‹è¦‹&lt;a href=&quot;https://pofat.dev/2019/05/21/%E9%87%8D%E6%96%B0%E6%AA%A2%E8%A6%96-swift-%E7%9A%84-protocol-%E4%BA%8C.html&quot;&gt;é‡æ–°æª¢è¦– Swift çš„ Protoclï¼ˆäºŒï¼‰&lt;/a&gt;ï¼‰ï¼Œå°±è¿ä¾† WWDC 2019ï¼Œåœ¨è¬çœ¾çŸšç›®çš„ SwiftUI è£¡ç«‹åˆ»å±•ç¾äº†å®˜æ–¹è§£æ±ºé€™å€‹å•é¡Œçš„å¸¥æ°£æ‰‹æ³•ï¼Œ&lt;code class=&quot;highlighter-rouge&quot;&gt;some View&lt;/code&gt;ï¼Œä¹Ÿé©é€¢ Podcast æå•ç®±æœ‰äººæå•ä»€éº¼æ˜¯ &lt;a href=&quot;https://github.com/apple/swift-evolution/blob/master/proposals/0244-opaque-result-types.md&quot;&gt;Opaque Result Type&lt;/a&gt; ï¼Œæœ¬æœŸ Podcast åªæœ‰é»åˆ°æ²’æœ‰æ·±èŠï¼Œæ‰€ä»¥åœ¨é€™è¨è«–ä¸€ä¸‹ã€‚&lt;/p&gt;

&lt;h2 id=&quot;ç‚ºä½•è¦æœ‰-opaque-result-type&quot;&gt;ç‚ºä½•è¦æœ‰ Opaque Result Type&lt;/h2&gt;

&lt;p&gt;é¦–å…ˆäº†è§£ä¸€ä¸‹é€™å€‹ç‰¹æ€§è¦è§£æ±ºä»€éº¼ Swift 5.1 å‰ç„¡æ³•è§£æ±ºçš„å•é¡Œï¼š&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;å‹åˆ¥ä¸Šå°è¿”å›é¡å‹çš„æŠ½è±¡åŒ–ç„¡æ³•è¢«å¯¦ç¾ (Type-level abastraction of returns)&lt;/li&gt;
  &lt;li&gt;ç„¡æ³•å»ºç«‹å¸¶æœ‰æ³›å‹é¡å‹çš„ existentail container ï¼ˆä¹Ÿå°±æ˜¯ç„¡æ³•ç”¨ PAT åšç‚ºä¸€ç¨®é¡å‹ï¼‰&lt;/li&gt;
  &lt;li&gt;å¦‚æœæœ‰å·¢ç‹€çµæ§‹æˆ–æ˜¯é‚£ç¨®å¤šå±¤çš„æ³›å‹ä½¿ç”¨æ™‚å¸¸æœƒéœ€è¦åœ¨å®£å‘Šæ™‚æŒ‡æ˜å¤šå±¤åˆè‡­åˆé•·çš„å„å±¤é¡å‹ï¼Œåƒæ˜¯ï¼š&lt;/li&gt;
&lt;/ol&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-swift&quot; data-lang=&quot;swift&quot;&gt;&lt;span class=&quot;kd&quot;&gt;protocol&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Shape&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{}&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Rectangle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Shape&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{}&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Union&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;B&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Shape&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Shape&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Shape&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Shape&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Transformed&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;S&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Shape&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Shape&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;S&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;protocol&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;GameObject&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;associatedtype&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;ShapeType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Shape&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;ShapeType&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;get&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;EightPointedStar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;GameObject&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Union&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Rectangle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Transformed&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Rectangle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Union&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Rectangle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Transformed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Rectangle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()))&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;å¯è¦‹æœ€å¾Œ &lt;code class=&quot;highlighter-rouge&quot;&gt;EightPointedStar.shape&lt;/code&gt; çš„å®šç¾©æ˜¯å¤šéº¼åœ°å¯æ€•ï¼Œä»¥ä¸Šå¹¾å€‹å•é¡Œå…¶å¯¦éƒ½ä¾†è‡ªæ–¼ä¸€å€‹åŸå…ˆ Swift æ³›å‹ç³»ç¶‚è¨­è¨ˆçš„ä¸è¶³ï¼Œé‚£å°±æ˜¯:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;åªèƒ½ç”±å‘¼å«æ–¹(caller)ä¾†æ±ºå®šè¢«å‘¼å«æ–¹(callee)æ³›å‹åƒæ•¸æœ€çµ‚è¦å¡«å…¥çš„çœŸæ­£å‹åˆ¥&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;æˆ‘å€‘å›é¡§ä¸€ä¸‹å¯¦ä¾‹ï¼š&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-swift&quot; data-lang=&quot;swift&quot;&gt;&lt;span class=&quot;kd&quot;&gt;protocol&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Shape&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;draw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Triangle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Shape&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// æœƒå°å‡ºï¼š&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// *&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// **&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// ***&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;draw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]()&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;length&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;repeating&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;*&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;joined&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;separator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;FlippedShape&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Shape&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Shape&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;T&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;draw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;lines&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;draw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;separator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lines&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;reversed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;joined&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;separator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;smallTriangle&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Triangle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;flippedTriangle&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;FlippedShape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;smallTriangle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// é€™è£¡ç”± FlippedShape æ±ºå®š T == Triangle&lt;/span&gt;
&lt;span class=&quot;nf&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flippedTriangle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;draw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// ***&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// **&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// *&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;æ‰€ä»¥ Opaque Result Type æœ€é‡è¦çš„ç²¾ç¥å°±æ˜¯è®“è¢«å‘¼å«æ–¹ï¼ˆcalleeï¼‰ï¼Œä¹Ÿå°±æ˜¯å¯¦ä½œæ–¹æ±ºå®šè¦å›ä»€éº¼çœŸå¯¦çš„å‹åˆ¥ï¼›å› æ­¤å¤–éƒ¨å‘¼å«å¾Œå¾—åˆ°çš„å°±æœƒæ˜¯ä¸€å€‹æŠ½è±¡çš„å‹åˆ¥ï¼Œé€™é»èˆ‡å…ˆå‰åœ¨å®£å‘Šæ™‚çµ¦åƒæ•¸ï¼Œå¤–éƒ¨éœ€è¦æ˜ç¢ºåœ°çµ¦äºˆä¸€å€‹æ±ºå®šæ€§çš„çœŸå¯¦å‹åˆ¥ç›¸åï¼Œå¯ä»¥è¦–ä½œæ˜¯åå‘çš„æ³›å‹ï¼ˆreverse-genericï¼‰ã€‚&lt;/p&gt;

&lt;p&gt;æœ‰äº†é€™å€‹ç‰¹æ€§ï¼Œæˆ‘å€‘å‰é¢çš„ &lt;code class=&quot;highlighter-rouge&quot;&gt;EightPointedStar&lt;/code&gt; å°±å¯ä»¥ç°¡åŒ–æˆ&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-swift&quot; data-lang=&quot;swift&quot;&gt;&lt;span class=&quot;kd&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;EightPointedStar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;GameObject&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;some&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Shape&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Union&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Rectangle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Transformed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Rectangle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()))&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;è‡³æ–¼ PATï¼Œæˆ‘å€‘å°±æ‹¿ SwiftUI è£¡çš„ &lt;code class=&quot;highlighter-rouge&quot;&gt;some View&lt;/code&gt; ä¾†èªªæ˜ï¼ŒåŸºæœ¬ä¸Š &lt;code class=&quot;highlighter-rouge&quot;&gt;View&lt;/code&gt; æ˜¯ä¸€å€‹å¸¶æœ‰ associated type çš„ Protocol&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-swift&quot; data-lang=&quot;swift&quot;&gt;&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;protocol&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;View&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;associatedtype&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Body&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;View&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;Self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Body&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;get&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;ä½¿ç”¨ä¸Šæ˜¯é€™æ¨£çš„&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-swift&quot; data-lang=&quot;swift&quot;&gt;&lt;span class=&quot;kd&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;ContentView&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;View&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;some&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;View&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;Text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Hello World&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;å¦‚æ­¤ä¸€ä¾†å¯¦ä½œ &lt;code class=&quot;highlighter-rouge&quot;&gt;View&lt;/code&gt; Protocol çš„ ContentView å¯ä»¥è‡ªç”±åœ°æ±ºå®šè¦ç”Ÿæˆä»€éº¼ viewï¼Œå†ä¹Ÿä¸æ˜¯é å¤–éƒ¨æ±ºå®šäº†ï¼Œä¹Ÿå› æ­¤ SwiftUI åœ¨ runtime å‘¼å« &lt;code class=&quot;highlighter-rouge&quot;&gt;body&lt;/code&gt; æ™‚ç„¡æ³•è·Ÿæˆ‘å€‘ä»¥å‰çš„ä½¿ç”¨ç¿’æ…£ä¸€æ¨£ï¼Œå®ƒçœ‹åˆ°çš„æ˜¯ä¸€å€‹æŠ½è±¡çš„å‹åˆ¥ï¼Œè¦ç”¨éè¿´çš„æ–¹å¼é€ä¸€æª¢æŸ¥æ‰€æœ‰çš„ view åˆ°åº•æœ‰å“ªäº›å…·é«”å‹åˆ¥ï¼Œé€™å…¶ä¸­ä¹Ÿæœ‰ç”¨ &lt;a href=&quot;https://forums.swift.org/t/dynamicviewproperty/25627/4&quot;&gt;metadata&lt;/a&gt; ä¾†å¹«å¿™è§£æé€™äº›è³‡è¨Šã€‚&lt;/p&gt;

&lt;h2 id=&quot;é™åˆ¶èˆ‡æ³¨æ„äº‹é …&quot;&gt;é™åˆ¶èˆ‡æ³¨æ„äº‹é …&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;æœ€çµ‚çš„å…·é«”å‹åˆ¥è¦åœ¨ compile time èƒ½ç¢ºå®šï¼Œæ¯”å¦‚ä½ ä¸èƒ½å¯«å‡º&lt;/li&gt;
&lt;/ul&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-swift&quot; data-lang=&quot;swift&quot;&gt;&lt;span class=&quot;kd&quot;&gt;protocol&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;P&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;extension&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;P&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;extension&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;P&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;f1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;condition&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Bool&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;some&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;P&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;condition&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;opaque&quot;&lt;/span&gt;   &lt;span class=&quot;c1&quot;&gt;// compile error&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;ul&gt;
  &lt;li&gt;æœ€çµ‚é‚„æ˜¯æœƒå°æ‡‰åˆ°ä¸€å€‹å…·é«”çš„å‹åˆ¥çš„ï¼Œä¸”å…·æœ‰å–®ä¸€æ€§&lt;/li&gt;
&lt;/ul&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-swift&quot; data-lang=&quot;swift&quot;&gt;&lt;span class=&quot;kd&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Equatable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;some&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Equatable&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;condition&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// åˆæ³•, å› ç‚º xã€y æ˜¯åŒä¸€å€‹æ³›å‹åƒæ•¸&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;condition&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1738&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;679&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;apples&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;bananas&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;apples&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;some fruit nobody's ever heard of&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;nf&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// ä¹Ÿåˆæ³•ï¼Œå› ç‚ºåŒå€‹æ³›å‹åƒæ•¸&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;ä»¥ä¸‹åšæ³•æ˜¯ä¸åˆæ³•çš„&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-swift&quot; data-lang=&quot;swift&quot;&gt;&lt;span class=&quot;kd&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;makeOpaque&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;Type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;some&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Any&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;cm&quot;&gt;/* ... */&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;makeOpaque&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;makeOpaque&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Double&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// compile errorï¼Œå› ç‚º x çš„å‹åˆ¥æ‡‰è©²æ˜¯ Any&amp;lt;Int&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;ul&gt;
  &lt;li&gt;ä¸å¯åŒ…åœ¨ Optional ä¸­ï¼Œä¸å¯å®£å‘Šåœ¨ protocol ä¸­&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ä»¥ä¸‹çš„å¯«æ³•ä¹Ÿéƒ½ä¸è¡Œï¼Œcompiler æœƒæŠ±æ€¨çš„ï¼&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-swift&quot; data-lang=&quot;swift&quot;&gt;&lt;span class=&quot;kd&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;flip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Bool&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;some&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;P&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)?&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// ...&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;protocol&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Q&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;some&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;P&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;åƒè€ƒè³‡æ–™&quot;&gt;åƒè€ƒè³‡æ–™&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;weak self ç¬¬äºŒé›†ï¼š&lt;a href=&quot;https://twitter.com/weak_self/status/1158049319653560321&quot;&gt;åŸä¾†æˆ‘ä¸æœƒç”¨ protocol&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name>Pofat</name></author><category term="Swift" /><category term="protocol" /><category term="SwiftUI" /><summary type="html">ä¸Šæ¬¡å¯«å®Œ PAT (Protcol with Assocaited Type) ä¸èƒ½åšç‚ºå‹åˆ¥çš„å¦ä¸€ç¨®è§£æ³•æ²’å¤šä¹…ï¼ˆè«‹è¦‹é‡æ–°æª¢è¦– Swift çš„ Protoclï¼ˆäºŒï¼‰ï¼‰ï¼Œå°±è¿ä¾† WWDC 2019ï¼Œåœ¨è¬çœ¾çŸšç›®çš„ SwiftUI è£¡ç«‹åˆ»å±•ç¾äº†å®˜æ–¹è§£æ±ºé€™å€‹å•é¡Œçš„å¸¥æ°£æ‰‹æ³•ï¼Œsome Viewï¼Œä¹Ÿé©é€¢ Podcast æå•ç®±æœ‰äººæå•ä»€éº¼æ˜¯ Opaque Result Type ï¼Œæœ¬æœŸ Podcast åªæœ‰é»åˆ°æ²’æœ‰æ·±èŠï¼Œæ‰€ä»¥åœ¨é€™è¨è«–ä¸€ä¸‹ã€‚</summary></entry><entry><title type="html">Value Type ä¹Ÿæœƒåœ¨ Heap è£¡å—ï¼Ÿ</title><link href="http://localhost:4000/2019/07/30/Value-Type-%E6%9C%83%E5%9C%A8-Heap-%E8%A3%A1%E5%97%8E.html" rel="alternate" type="text/html" title="Value Type ä¹Ÿæœƒåœ¨ Heap è£¡å—ï¼Ÿ" /><published>2019-07-30T00:00:00+08:00</published><updated>2019-07-30T00:00:00+08:00</updated><id>http://localhost:4000/2019/07/30/Value-Type-%E6%9C%83%E5%9C%A8-Heap-%E8%A3%A1%E5%97%8E</id><content type="html" xml:base="http://localhost:4000/2019/07/30/Value-Type-%E6%9C%83%E5%9C%A8-Heap-%E8%A3%A1%E5%97%8E.html">&lt;p&gt;æœ€è¿‘å’Œå…©ä½å¿—åŒé“åˆçš„ iOS ç™¼ç‡’å‹ï¼ˆç¾åœ¨é‚„æœ‰äººç”¨é€™è©å—ï¼Ÿï¼‰ä¸€èµ·é–‹è¾¦äº†ä¸€å€‹é‡å° iOS é–‹ç™¼è€…çš„ä¸­æ–‡ Podcastï¼Œç¬¬ä¸€é›†å°±æ¦®å¹¸åœ°æœ‰å¤§å¸«ä¾†è¸¢é¤¨ï¼Œå› ç‚ºæˆ‘å€‘åœ¨ç¯€ç›®è£¡æåˆ° Swift çš„ value types éƒ½æœƒåœ¨ stack è£¡ï¼Œå¤§å¸« CJ è¡¨ç¤ºä¸å°å–”ï¼Œè‹¥æ˜¯ reference type çš„ value property æˆ–è€…è¢« closure æ•ç²çš„ value type éƒ½æœƒåœ¨ heap è£¡ï¼&lt;/p&gt;

&lt;iframe src=&quot;https://giphy.com/embed/fdRLQ2ApeAYkaXqXML&quot; width=&quot;480&quot; height=&quot;480&quot; style=&quot;display:block&quot; frameborder=&quot;0&quot; class=&quot;giphy-embed&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;

&lt;p&gt;é€™å°±æœ‰è¶£äº†ä¸è¿½ç©¶ä¸è¡Œï¼Œä½†ç¾åœ¨é‚„æ²’æœ‰èƒ½åŠ›çœ‹å®Œ Swift run time çš„ source codeï¼Œåªå¥½ç¡¬è‘—é ­çš®æƒ³äº†å€‹æ¹Šåˆçš„è¾¦æ³•ä¾†å¯¦é©—ä¸€ä¸‹ã€‚&lt;/p&gt;

&lt;h2 id=&quot;æŒ‡å‘-class-instance-çš„-header-pointer&quot;&gt;æŒ‡å‘ Class Instance çš„ Header Pointer&lt;/h2&gt;

&lt;p&gt;ä»¥å‰çœ‹æŒ‡æ¨™æ–‡ç« æ™‚æœ‰ç©éç›´æ¥å–å¾—ä½å€å¾Œï¼Œå¯ä»¥å°ä½å€å…§å®¹ç¡¬æ”¹å€¼ä»¥æ”¹è®Šæœ¬è©²ç„¡æ³•è¢« mutate çš„æ±è¥¿ï¼ˆæ¯”å¦‚ &lt;code class=&quot;highlighter-rouge&quot;&gt;let&lt;/code&gt; ï¼‰
æ‰€ä»¥æˆ‘å€‘å…ˆå®£å‘Šä¸€å€‹ class ï¼Œå»ºç«‹ä¸€å€‹ instanceï¼Œæˆ‘å€‘çŸ¥é“é€™å€‹ instance å¯¦éš›ä¸Šçš„å…§å®¹æœƒå­˜åœ¨ heap è£¡çš„ä¸€å¡Šé€£çºŒç©ºé–“è£¡ï¼Œç„¶å¾Œæˆ‘å€‘æä¸€å€‹æŒ‡å‘å®ƒ instance é–‹é ­çš„æŒ‡æ¨™ï¼š&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-swift&quot; data-lang=&quot;swift&quot;&gt;&lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Person&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Pofat&quot;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;age&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;18&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;married&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;pofat&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Person&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;headerPointer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Unmanaged&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;passUnretained&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pofat&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;AnyObject&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;toOpaque&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;ç…§ç†ä¾†èªªé€™å€‹ instance è£¡æ‰€æœ‰çš„ property æ‡‰è©²æœƒä¾è‘—å®£å‘Šçš„é †åºä¾åºæ“ºåœ¨é€™å€‹ &lt;code class=&quot;highlighter-rouge&quot;&gt;headerPointer&lt;/code&gt; æŒ‡å‘çš„ä½å€ä¹‹å¾Œï¼Œä¸é class å‰é¢æœ‰å…©å€‹ byte æ˜¯ç”¨ä¾†æ”¾ descriptor ä»¥åŠ retain countï¼Œæ‰€ä»¥ property æœƒå¾ç¬¬ä¸‰å€‹ byte é–‹å§‹ï¼Œæˆ‘å€‘ç”¨ &lt;code class=&quot;highlighter-rouge&quot;&gt;MemoryLayout&lt;/code&gt; ä¾†å–å¾—å„å€‹ property æ‰€ä½”çš„ç©ºé–“å¤§å°ï¼Œä¾åºæ‰¾å‡º &lt;code class=&quot;highlighter-rouge&quot;&gt;name&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;age&lt;/code&gt; ä»¥åŠ &lt;code class=&quot;highlighter-rouge&quot;&gt;married&lt;/code&gt; çš„ä½å€ï¼š&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-swift&quot; data-lang=&quot;swift&quot;&gt;&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;nameOffset&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;ageOffset&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nameOffset&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;MemoryLayout&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stride&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;marriedOffset&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ageOffset&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;MemoryLayout&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stride&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Bound to the type of each property&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;namePointer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;haderPointer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;advanced&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;by&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nameOffset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;assumingMemoryBound&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;agePointer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;headerPointer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;advanced&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;by&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ageOffset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;assumingMemoryBound&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;marriedPointer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;headerPointer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;advanced&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;by&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;marriedOffset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;assumingMemoryBound&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Bool&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;é€™äº›ä½å€ç•¶ç„¶é‚„æ˜¯åœ¨ heap è£¡ï¼Œè€Œä¸”æ‡‰è©²æŒ‡åˆ°å°±æ˜¯é€™äº› value type çš„ property æ‰€åœ¨åœ°ï¼ˆå§ï¼‰ï¼Œæˆ‘å€‘ç›´æ¥å¼·è¡Œæ”¹è®Šé€™äº›ä½ç½®ä¸Šçš„å€¼å¯¦é©—çœ‹çœ‹:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-swift&quot; data-lang=&quot;swift&quot;&gt;&lt;span class=&quot;n&quot;&gt;namePointer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pointee&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Joe&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;agePointer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pointee&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;marriedPointer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pointee&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;

&lt;span class=&quot;nf&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pofat&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;       &lt;span class=&quot;c1&quot;&gt;// get &quot;Joe&quot;&lt;/span&gt;
&lt;span class=&quot;nf&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pofat&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;age&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;        &lt;span class=&quot;c1&quot;&gt;// get 30&lt;/span&gt;
&lt;span class=&quot;nf&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pofat&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;married&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;    &lt;span class=&quot;c1&quot;&gt;// get false&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;OKï¼Œæˆ‘å€‘å¯ä»¥çœ‹åˆ°å€¼å¦‚é æ–™åœ°è®ŠåŒ–äº†ï¼Œé€™äº› value type çœŸçš„æ˜¯åœ¨ heap è£¡å•Šï¼
ä¹Ÿç”¨äº† Colab åšäº†ä¸€å€‹å¯ä»¥ç›´æ¥åœ¨ç·šä¸Š run code çš„&lt;a href=&quot;https://t.co/oiTZvLTKDB?amp=1&quot;&gt;ç‰ˆæœ¬&lt;/a&gt;ã€‚&lt;/p&gt;

&lt;h2 id=&quot;åƒè€ƒè³‡æ–™&quot;&gt;åƒè€ƒè³‡æ–™&lt;/h2&gt;

&lt;ol&gt;
  &lt;li&gt;weak self ç¬¬ä¸€é›†ï¼š&lt;a href=&quot;https://twitter.com/weak_self/status/1155511615661285376?s=21&quot;&gt;Swift API è¨­è¨ˆä¹‹ Value Type èˆ‡ Reference Type&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;é…„è¿è¨‚é–±13ã€å–¬å–¬å’Œæˆ‘å…±åŒè£½ä½œçš„ Podcast ï¼Œé€™è£¡æœ‰&lt;a href=&quot;http://bit.ly/weak_self_podcast&quot;&gt;è¨‚é–±æŒ‡å—&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;CJ Lin å¤§å¤§ä¸å&lt;a href=&quot;https://twitter.com/eJamesLin/status/1155857719863042053&quot;&gt;æŒ‡æ•™&lt;/a&gt; èˆ‡ä»–æ¨è–¦çš„&lt;a href=&quot;https://link.medium.com/v96sFdHDIY&quot;&gt;æ–‡ç« &lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;</content><author><name>Pofat</name></author><category term="Swift" /><category term="struct" /><summary type="html">æœ€è¿‘å’Œå…©ä½å¿—åŒé“åˆçš„ iOS ç™¼ç‡’å‹ï¼ˆç¾åœ¨é‚„æœ‰äººç”¨é€™è©å—ï¼Ÿï¼‰ä¸€èµ·é–‹è¾¦äº†ä¸€å€‹é‡å° iOS é–‹ç™¼è€…çš„ä¸­æ–‡ Podcastï¼Œç¬¬ä¸€é›†å°±æ¦®å¹¸åœ°æœ‰å¤§å¸«ä¾†è¸¢é¤¨ï¼Œå› ç‚ºæˆ‘å€‘åœ¨ç¯€ç›®è£¡æåˆ° Swift çš„ value types éƒ½æœƒåœ¨ stack è£¡ï¼Œå¤§å¸« CJ è¡¨ç¤ºä¸å°å–”ï¼Œè‹¥æ˜¯ reference type çš„ value property æˆ–è€…è¢« closure æ•ç²çš„ value type éƒ½æœƒåœ¨ heap è£¡ï¼</summary></entry><entry><title type="html">é‡æ–°æª¢è¦– Swift çš„ Protocolï¼ˆä¸‰ï¼‰</title><link href="http://localhost:4000/2019/05/22/%E9%87%8D%E6%96%B0%E6%AA%A2%E8%A6%96-swift-%E7%9A%84-protocol-%E4%B8%89.html" rel="alternate" type="text/html" title="é‡æ–°æª¢è¦– Swift çš„ Protocolï¼ˆä¸‰ï¼‰" /><published>2019-05-22T00:00:00+08:00</published><updated>2019-05-22T00:00:00+08:00</updated><id>http://localhost:4000/2019/05/22/%E9%87%8D%E6%96%B0%E6%AA%A2%E8%A6%96-swift-%E7%9A%84-protocol-%E4%B8%89</id><content type="html" xml:base="http://localhost:4000/2019/05/22/%E9%87%8D%E6%96%B0%E6%AA%A2%E8%A6%96-swift-%E7%9A%84-protocol-%E4%B8%89.html">&lt;p&gt;è®“æˆ‘å€‘ç›´æ¥ä¾†åˆ°ä¸‰éƒ¨æ›²çš„çµ‚ç« ï¼Œç‚ºäº†ç‡Ÿé€ çµ‚å±€çš„é«˜æ½®æˆ‘å¡äº†ä¸å°‘è³‡è¨Šåœ¨é€™ç¯‡æ–‡ç« è£¡ï¼Œå¤§å®¶å…ˆå–é»æ°´ä¼¸å±•ä¸€ä¸‹ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/rMFuHjT.jpg&quot; alt=&quot;really&quot; /&gt;&lt;/p&gt;

&lt;p&gt;å‰ç¯‡æåˆ°äº†ä¸€å€‹ç ´å¤©è’çš„æƒ³æ³•ï¼Œè‡ªå·±å¯¦åšä¸€å€‹ Protocol Witness Tableï¼Œæ‰€ä»¥æˆ‘å€‘å…ˆä¾†æ·±å…¥é»çœ‹çœ‹ Protocol Witness Tableï¼Œé¦–å…ˆæ˜¯ compiler åœ¨ SIL éšæ®µåšäº†ä»€éº¼äº‹ï¼ˆ&lt;a href=&quot;https://github.com/apple/swift/blob/d24bc387973bcf60f5596ff387b996c1eb356456/docs/SIL.rst#witness-tables&quot;&gt;å®˜æ–¹æ–‡ä»¶&lt;/a&gt;ï¼‰ï¼Œé¦–å…ˆæ–‡ä»¶è£¡æåˆ°ï¼š&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;A witness table is emitted for every declared explicit conformance.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;æ‰€ä»¥æ¯ç•¶æˆ‘å€‘ç•¶è²æ˜ä¸€å€‹å‹åˆ¥éµå®ˆ(confrom to)æŸå€‹ Protocol æ™‚å°±æœƒç”Ÿæˆä¸€å€‹ witness tableï¼Œè€Œé€™å€‹ witness table æœƒç”¨ã€Œå‹åˆ¥ï¼šProtocolã€é€™çµ„åˆç”Ÿæˆä¸€å€‹ç¨ç‰¹çš„ id ä¾†ç•¶ key ä¿å­˜è‘—ï¼Œæ–‡ä»¶è£¡å…±å®šç¾©äº”ç¨®éµå®ˆ protocol çš„å¯èƒ½æ€§ï¼Œæˆ‘å€‘åªçœ‹æœ€ä¸€èˆ¬çš„ä¸€èˆ¬æ€§éµå®ˆ&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;protocol-conformance ::= normal-protocol-conformance&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;å› ç‚ºæ¯å€‹å‹åˆ¥åªèƒ½éµå®ˆä¸€å€‹ protocol ä¸€æ¬¡ï¼ˆé‡é»é‡é»ï¼ï¼‰ï¼Œæ‰€ä»¥å¯ä»¥ä¿è­‰é€™æ¨£çš„é…å°æ˜¯ 1:1ï¼Œè€Œä¸”ä¹Ÿåªæœ‰é€™å€‹ä¸€èˆ¬çš„éµå®ˆæ–¹å¼æœƒç›´æ¥èˆ‡ witness table é—œè¯ï¼Œå…¶å®ƒæ¯”è¼ƒè¤‡é›œçš„æƒ…æ³å¤šåŠæ˜¯é–“æ¥æˆ–å¤šå€‹ table ä¹‹é–“çš„é—œè¯ã€‚è‡³æ–¼ä¸€å€‹ witness table æœƒç”± 4 å€‹ entry çµ„æˆä»¥æè¿°æ‰€æœ‰ç›¸é—œè³‡è¨Šï¼Œæˆ‘å€‘åªåœ¨æ„æœ€é‡è¦çš„ä¸€å€‹ method entryï¼š&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;sil-witness-entry ::= 'method' sil-decl-ref ':' sil-function-name&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;é€™è£¡å¾ˆå–®ç´”ï¼Œå‰è€…æ˜¯ protocol æ‰€å®šç¾©çš„ä»‹é¢ï¼Œå¾Œè€…æ˜¯çœŸå¯¦çš„ method å¯¦ä½œï¼Œåªæ˜¯æŠŠå®ƒå€‘é€£çµèµ·ä¾†è€Œå·²ï¼Œå¦‚é€™è£¡å¤ªæŠ½è±¡æˆ‘å€‘å¯ä»¥çœ‹ä¸€ä¸‹åœ–å’Œç¨‹å¼ç¢¼ï¼Œå°±æ‹¿ WWDC 2016 &lt;a href=&quot;https://developer.apple.com/videos/play/wwdc2016/416/&quot;&gt;Session 416&lt;/a&gt; çš„ç¯„ä¾‹ä¾†èªªï¼š&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-swift&quot; data-lang=&quot;swift&quot;&gt;&lt;span class=&quot;kd&quot;&gt;protocol&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Drawable&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;draw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Point&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Drawable&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;draw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nf&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Draw a point at (&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;, &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;)&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Main&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;point&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Drawable&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Point&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;point&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;draw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;æˆ‘å€‘é€™è£¡çš„è®Šæ•¸ point æœƒæ˜¯å€‹ Existential Containerï¼Œå› ç‚ºæˆ‘å€‘å®£å‘Šå®ƒçš„å‹åˆ¥æ˜¯å€‹ protocolï¼Œçµåˆå‰è¿°æ‰€èªªï¼Œcontainer å’Œ protocol witness table é•·å¾—åƒé€™æ¨£ï¼ˆå¤§å®¶é‚„è¨˜å¾—&lt;a href=&quot;https://pofat.dev/2019/05/21/%E9%87%8D%E6%96%B0%E6%AA%A2%E8%A6%96-swift-%E7%9A%84-protocol-%E4%BA%8C.html&quot;&gt;ç¬¬äºŒé›†&lt;/a&gt;è¬›åˆ° container çš„æ¨¡æ¨£å—ï¼Ÿï¼‰&lt;/p&gt;

&lt;figure class=&quot;image&quot;&gt;
  &lt;img src=&quot;https://i.imgur.com/WwlbY0v.png&quot; alt=&quot;åœ–ç‰‡ä¾†æºï¼šhttps://developer.apple.com/videos/play/wwdc2016/416/&quot; /&gt;
  &lt;figcaption&gt;åœ–ç‰‡ä¾†æºï¼šhttps://developer.apple.com/videos/play/wwdc2016/416/&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;å¦‚æœç”¨ç¨‹å¼ç¢¼è¡¨ç¤ºï¼Œé€™å€‹ point çš„ container èˆ‡ Point: Drawable çš„ witness table æœƒåƒé€™æ¨£ï¼š&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-swift&quot; data-lang=&quot;swift&quot;&gt;&lt;span class=&quot;kd&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;ExistentialContainer&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;valueBuffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;vwt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;UnsafePointer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;ValueWitness&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;pwt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;UnsafePointer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;ProtocolWitness&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;ProtocolWitness&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;descriptor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;ProtocolConformanceDescriptor&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;draw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;FunctionRef&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;æ‡·ç–‘è«–è€…è‡³æ­¤å¦‚æœé‚„æœ‰æ‡·ç–‘ï¼Œå¯ä»¥è©¦è‘—åœ¨å‰é¢çš„ point.draw() æ‰“å€‹ä¸­æ–·é»ï¼ŒåŸ·è¡Œç¨‹å¼ä¸¦åœåœ¨è©²è™•ï¼Œåœ¨ lldb è£¡è®€ä¸€ä¸‹ register ï¼Œå¯ä»¥çœ‹åˆ°ï¼š&lt;/p&gt;

&lt;figure class=&quot;image&quot;&gt;
  &lt;img src=&quot;https://i.imgur.com/L07LC6v.png&quot; alt=&quot;æ³¨æ„ $rsi æš«å­˜å™¨&quot; /&gt;
  &lt;figcaption&gt;æ³¨æ„ $rsi æš«å­˜å™¨&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;&lt;br /&gt;
å…¶ä¸­ 0x000000010fb21978 æ˜¯ protocol witness tableï¼Œæˆ‘å€‘æª¢æŸ¥ä¸€ä¸‹è£¡é¢çš„å…§å®¹&lt;/p&gt;
&lt;figure class=&quot;image&quot;&gt;
  &lt;img src=&quot;https://i.imgur.com/YsP4ywG.png&quot; alt=&quot;&quot; /&gt;
  &lt;figcaption&gt;&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;&lt;br /&gt;
ç¬¬ä¸€å€‹æ˜¯æŒ‡å‘ descriptor ï¼Œç¬¬äºŒå€‹å°±æ˜¯æŒ‡å‘æˆ‘å€‘ draw() åœ¨ point çš„å¯¦ä½œï¼Œæˆ‘å€‘å°‡ç¬¬äºŒå€‹çš„ä½å€åçµ„è­¯ä¸€ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°å®ƒçš„ç¢ºå°±æ˜¯ Point å° Drawable è£¡ draw() çš„å¯¦ä½œï¼ˆåœ¨æˆ‘ç¨‹å¼è£¡æ˜¯ç¬¬ 19 è¡Œæ²’éŒ¯ï¼‰&lt;/p&gt;

&lt;figure class=&quot;image&quot;&gt;
  &lt;img src=&quot;https://i.imgur.com/EGbNYi8.png&quot; alt=&quot;&quot; /&gt;
  &lt;figcaption&gt;&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;æ¢ç©¶è‡³æ­¤ï¼Œæƒ³å¿…å¤§å®¶éƒ½å·²ç¶“æœ‰å¾ˆå…·é«”çš„èªçŸ¥äº†ï¼Œé‚£æˆ‘å€‘æƒ³æƒ³ï¼Œé€™æ¨£çš„è¨­è¨ˆå¯èƒ½æœƒæœ‰ä»€éº¼å•é¡Œï¼Ÿ&lt;/p&gt;

&lt;p&gt;é™¤äº†å‰é›†æåˆ°çš„ PAT ä¸èƒ½ç”Ÿæˆ container å¤–ï¼Œæœ‰æ™‚é€™ 1å°1 çš„é—œä¿‚ï¼ˆä¸€å‹åˆ¥åªèƒ½éµå®ˆä¸€å€‹ protocol ä¸€æ¬¡ï¼‰è®“æˆ‘å€‘ä¸èƒ½ä»¥æœ€å¤§æ•ˆç›Šå…±ç”¨ç¨‹å¼ç¢¼ï¼Œæ¯”å¦‚å‰ä¸€é›†æåˆ° Request ï¼ˆå¿˜è¨˜ä¾†&lt;a href=&quot;https://pofat.dev/2019/05/21/%E9%87%8D%E6%96%B0%E6%AA%A2%E8%A6%96-swift-%E7%9A%84-protocol-%E4%BA%8C.html&quot;&gt;é€™è£¡&lt;/a&gt;çœ‹ï¼‰ï¼Œå¦‚æœæˆ‘å€‘æƒ³è¦ç”Ÿæˆä¸åŒå›å‚³å‹åˆ¥çš„ Request ï¼Œå°±è¦å®£å‘Šä¸åŒçš„ concrete type ï¼Œæ¯”å¦‚ UserRequestï¼ŒListsRequestç­‰ï¼Œå…¶å¯¦å¤§åŒå°ç•°ï¼Œé€™æ¨£å°±è¦å®£å‘Šä¸€å€‹æ–°å‹åˆ¥å¥½åƒæœ‰é»æµªè²»ï¼Ÿ&lt;/p&gt;

&lt;h2 id=&quot;ä¸å¦‚è‡ªå·±ä¾†å¯¦ä½œ-witness-table-å§&quot;&gt;ä¸å¦‚è‡ªå·±ä¾†å¯¦ä½œ witness table å§ï¼&lt;/h2&gt;

&lt;p&gt;å¾å‰é¢ Point å’Œ Drawable çš„ä¾‹å­ä¾†çœ‹ï¼Œå¦‚æœæˆ‘å€‘å¸Œæœ› Point æœ‰ä¸åŒçš„ç•«æ³•å‘¢ï¼Ÿæ¯”å¦‚ç©ºå¿ƒé»ã€å¯¦å¿ƒé»æˆ–è€…è™›ç·šé»ï¼Œé€™æ¨£å‹¢å¿…è¦ä¸‰ç¨®å‹åˆ¥æ‰èƒ½é”æˆå•Šï¼Œä¸ç®¡æ˜¯ç´”éµå®ˆ protocol æˆ–è€…ä½¿ç”¨ç¹¼æ‰¿ ï¼ä¸éæ–¹æ‰æˆ‘å€‘ä¹Ÿçœ‹åˆ° witness table åœ¨ SIL çš„çµæ§‹ï¼Œçœ‹èµ·ä¾†ä¸é›£æï¼Œå…¶å¯¦å°±æ˜¯ draw è¦ä¿å­˜ä¸€å€‹å¯¦ä½œçš„ä½å€å˜›ï¼åœ¨ Swift è£¡ function å¯æ˜¯ â€œfirst-class citizenâ€ï¼Œä¹Ÿå°±æ˜¯ function å¯ä»¥ç•¶ä½œè®Šæ•¸ä¾†é‹ç”¨ï¼Œé€™æä¾›äº†ä¸€å€‹å¤§å¥½çš„å¥‘æ©Ÿï¼Œæˆ‘å€‘å¯ä»¥æŠŠ Drawable witness table çš„ draw property æ”¹å¯«ä¸€ä¸‹&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;var draw: FunctionRef -&amp;gt; var draw: (Shape) -&amp;gt; ()&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;æ•´å€‹ä¾‹å­å°±å¯ä»¥æ”¹å¯«æˆ&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-swift&quot; data-lang=&quot;swift&quot;&gt;&lt;span class=&quot;c1&quot;&gt;// From:&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;protocol&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Drawable&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;draw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// To:&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Drawing&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Shape&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;draw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// ç”¨ä¾†ç•«å¯¦å¿ƒé»&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;solidPointDrawer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Drawing&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;CGPoint&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;point&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt;
    &lt;span class=&quot;nf&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;draw solid point: (&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;point&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;, &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;point&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;)&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// ç”¨ä¾†ç•«ç©ºå¿ƒé»&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;hollowPointDrawer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Drawing&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;CGPoint&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;point&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt;
    &lt;span class=&quot;nf&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;draw hollow point: (&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;point&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;, &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;point&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;)&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;                      

&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;point&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;CGPoint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;solidPointDrawer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;draw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;point&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// ç•«å¯¦å¿ƒé»&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;hollowPointDrawer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;draw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;point&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// ç•«ç©ºå¿ƒé»&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;æ˜¯ä¸æ˜¯çªç„¶å°±æœ‰èµ°å…¥æ–°ä¸–ç•Œçš„æ„Ÿè¦ºäº†å‘¢ï¼Ÿæ‰“éµè¦è¶ç†±ï¼Œæˆ‘å€‘ç¹¼çºŒæŠŠä¸Šæ¬¡çš„ network rqeust ç¯„ä¾‹ä¸€èµ·ç”¨é€™ç¨®æ–¹å¼é‡æ–°æ”¹å¯«ï¼ˆå› ç‚ºè¦å‚³å…¥ handler ä¸”å®ƒæ˜¯å€‹ closureï¼Œå¦‚æœè¦å¯«å¾—å„ªé›…é»éœ€è¦ç”¨ curry çš„æ–¹å¼æ¶ˆåƒæ•¸ï¼Œæ€•å¤±ç„¦å°±å…ˆå€Ÿç”¨ RxSwift è©²ç¨‹å¼ç¢¼å„ªé›…é»ï¼‰&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-swift&quot; data-lang=&quot;swift&quot;&gt;&lt;span class=&quot;kd&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Foundation&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;RxSwift&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// MARK: Model&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;User&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Decodable&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;usersDecode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;User&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]?&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;JSONDecoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;decode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;User&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;from&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// MARK: Request related&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;enum&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;HTTPMethod&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;GET&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;POST&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Request&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Decodable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;endpoint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;method&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;HTTPMethod&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;param&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Any&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]?&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;decode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;?&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;RequestSender&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;base&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;https://foo.bar&quot;&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;sendingRequst&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;URLRequest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Observable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// To abstract your network framework&lt;/span&gt;
    &lt;span class=&quot;nf&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;sendingRequst&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;@escaping(URLRequest)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Observable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendingRequst&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sendingRequst&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Decodable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Request&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Response&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Observable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;url&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;URL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;base&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;endpoint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;request&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;URLRequest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;httpMethod&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;method&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rawValue&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;param&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;param&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;body&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;JSONSerialization&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;withJSONObject&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;param&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prettyPrinted&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;httpBody&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;body&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;sendingRequst&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// MARK: Main&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// Instance of requests and request sender&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;getUsersRequest&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;endpoint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;/users&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;method&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;GET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;param&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;nil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;decode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;usersDecode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// You can use any other network framework such as Alamofire&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;urlSessionRequestSender&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;RequestSender&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;request&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Observable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;create&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;subscriber&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;task&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;URLSession&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shared&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;dataTask&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;error&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;subscriber&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;onNext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;subscriber&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;onError&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;resume&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Disposables&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Actually do request (get users)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;urlSessionRequestSender&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getUsersRequest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;subscribe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;onNext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;users&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;guard&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;users&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;users&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;
	&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;nf&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;users&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;RequestSender çš„éƒ¨åˆ†å°±å¯«å€‹æ„æ€æ„æ€ï¼ˆä½†çœŸçš„æœƒå‹•ï¼‰ï¼Œå¤§å®¶å¯ä»¥å†è‡ªå·±å„ªåŒ–ï¼Œä¸»è¦çš„é‡é»é‚„æ˜¯åœ¨ Request é€™å€‹æ³›å‹ struct è£¡ï¼Œåˆ©ç”¨å®ƒçš„æ³›å‹è³‡è¨Šå†è®“ RequestSender å¯ä»¥è™•ç†å„ç¨® return type çš„ requestã€‚&lt;/p&gt;

&lt;p&gt;ä»¥ä¸Šï¼Œprotocol å†æª¢è¦–ä¸‰éƒ¨æ›²åˆ°æ­¤çµæŸï¼Œå¸Œæœ›å°å¤§å®¶æœ‰å¹«åŠ©ï¼Œæ¥ä¸‹ä¾†è«‹å¤§å®¶æœŸå¾…ç¬¬ä¸€é›†ï¼ˆç–‘ï¼Ÿï¼‰&lt;/p&gt;

&lt;h2 id=&quot;å¾Œè¨˜èˆ‡åƒè€ƒè³‡æ–™&quot;&gt;å¾Œè¨˜èˆ‡åƒè€ƒè³‡æ–™&lt;/h2&gt;

&lt;p&gt;è‡ªå·±å¯¦ä½œ witness table çš„æƒ³æ³•ä¾†è‡ªæ–¼æ–¼ Brandon Willams çš„&lt;a href=&quot;https://www.fewbutripe.com/talks/#protocol-witnesses&quot;&gt;æ¼”è¬›&lt;/a&gt;ï¼ˆæ¨è–¦å¤§å®¶å€¼å¾—ä¸€çœ‹çš„å½±ç‰‡ï¼‰ï¼Œé€™å€‹æƒ³æ³•å¯¦åœ¨å¤ªé…·ç‚«ï¼Œæˆ‘ä¸€çŸ¥é“å¾Œç«‹åˆ»èˆˆå¥®å¾—æŠŠè‡ªå·±æ‰‹é‚Šçš„ protocol ç¯„ä¾‹å¯¦ä½œä¸€éï¼Œåœ¨æ­¤æ„Ÿè¬å¤§ç¥çš„æŒ‡æ•™è®“æˆ‘èµ°å…¥æ–°ä¸–ç•Œã€‚&lt;/p&gt;</content><author><name>Pofat</name></author><category term="Swift" /><category term="Protocol" /><summary type="html">è®“æˆ‘å€‘ç›´æ¥ä¾†åˆ°ä¸‰éƒ¨æ›²çš„çµ‚ç« ï¼Œç‚ºäº†ç‡Ÿé€ çµ‚å±€çš„é«˜æ½®æˆ‘å¡äº†ä¸å°‘è³‡è¨Šåœ¨é€™ç¯‡æ–‡ç« è£¡ï¼Œå¤§å®¶å…ˆå–é»æ°´ä¼¸å±•ä¸€ä¸‹ã€‚</summary></entry><entry><title type="html">é‡æ–°æª¢è¦– Swift çš„ Protocolï¼ˆäºŒï¼‰</title><link href="http://localhost:4000/2019/05/21/%E9%87%8D%E6%96%B0%E6%AA%A2%E8%A6%96-swift-%E7%9A%84-protocol-%E4%BA%8C.html" rel="alternate" type="text/html" title="é‡æ–°æª¢è¦– Swift çš„ Protocolï¼ˆäºŒï¼‰" /><published>2019-05-21T00:00:00+08:00</published><updated>2019-05-21T00:00:00+08:00</updated><id>http://localhost:4000/2019/05/21/%E9%87%8D%E6%96%B0%E6%AA%A2%E8%A6%96-swift-%E7%9A%84-protocol-%E4%BA%8C</id><content type="html" xml:base="http://localhost:4000/2019/05/21/%E9%87%8D%E6%96%B0%E6%AA%A2%E8%A6%96-swift-%E7%9A%84-protocol-%E4%BA%8C.html">&lt;h2 id=&quot;ç‚ºä½•å†è¬›-protocol&quot;&gt;ç‚ºä½•å†è¬› Protocol&lt;/h2&gt;

&lt;p&gt;æ›¾ç¶“åœ¨ Swift 2 å’Œ 3 äº¤æ¥ä¹‹è™•è¶è‘— Apple æ¨å‹• PoP ä¹‹å‹¢çµ¦äº†å¹¾å€‹è·Ÿ Protocol æœ‰é—œçš„ talkï¼Œéäº†å¹¾å¹´ä»¥ç‚º Swift æ‡‰è©²éƒ½æ˜¯ Protocol çš„å¤©ä¸‹ï¼Œå»ç™¼ç¾ä¸ç„¶ï¼Œåå€’æ˜¯è‡ªå·±é‡åˆ°çš„å°ˆæ¡ˆå’Œæœ‹å‹çš„å°ˆæ¡ˆéƒ½æœ‰ã€Œé€™3å° Protocolã€ã€ã€Œåˆ°è™•éƒ½ Protocol è¿½ code çœŸçš„å¥½éº»ç…©ã€çš„ç¶“é©—ã€‚ç¶“éåˆ†æï¼Œå¤§æ¦‚å¯ä»¥æ‰¾å‡ºå…©å€‹æ ¹æœ¬æ€§çš„å•é¡Œï¼ˆä¹Ÿè¨±é‚„æœ‰å…¶å®ƒçš„ï¼Œä½†æˆ‘åªæƒ³åˆ°é€™å…©å€‹å•¦ï¼‰ï¼š&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Protocol åƒ…åƒ…åªç”¨ä¾†åšç‚ºä¸€å±¤é•·å¾—è·Ÿ Object ä¸€æ¨£çš„çš®&lt;/li&gt;
  &lt;li&gt;PAT ï¼ˆProtocol with Associated Typeï¼‰ç„¡æ³•è¢«ç”¨ä¾†åšç‚ºä¸€ç¨® Type (Existential Container)&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;æ‰“ç®—åœ¨ç¬¬ä¸€é›†æ¢è¨ç¬¬ 1 é»ï¼Œç¬¬äºŒé›†è¬›ç¬¬ 2 é»ï¼Œä½†æ˜¯å¿ƒæƒ…ä¸Šæ¯”è¼ƒæƒ³å…ˆè¬›ç¬¬ 2 é›†é‚„æœ‰ç¬¬ 3 é›†æ‰€ä»¥å°±å…ˆé–‹å¹¹ï¼Œç¬¬ä¸€é›†æ—¥å¾Œå†è¬›ã€‚&lt;/p&gt;

&lt;h2 id=&quot;pat&quot;&gt;PAT&lt;/h2&gt;

&lt;p&gt;PAT å°±æ˜¯ä¸€å€‹æœ‰æ³›å‹èƒ½åŠ›çš„ Protocolï¼Œè®“ä½ çš„ Protocol æ›´èƒ½è¢«å»£æ³›é‹ç”¨ï¼Œæ›´å¼·å¤§ï¼Œæœ€å¸¸è¦‹çš„å°±æ˜¯ Sequence ï¼Œæˆ‘å€‘å¯ä»¥å¾ source code æ‰¾åˆ°å®ƒå®šç¾©å¦‚ä¸‹ï¼ˆç°¡åŒ–éï¼‰&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-swift&quot; data-lang=&quot;swift&quot;&gt;&lt;span class=&quot;kd&quot;&gt;protocol&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Sequence&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;associatedtype&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Element&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;associatedtype&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Iterator&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;IteratorProtocol&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;where&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Iterator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Element&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Element&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;makeIterator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Iterator&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;å¦‚æ­¤ä¸€ä¾†ï¼Œæˆ‘å€‘å°±å¯ä»¥åšå‡ºä¸€ç¾¤çš†åå‡º Int çš„å„ç¨® Iterator ï¼Œæˆ–è€…æ˜¯ Stringï¼Œå¯ä»¥å¤§å¤§åœ°ææ˜‡ç¨‹å¼ç¢¼çš„å…±ç”¨åº¦ï¼Œå¯æƒœçš„æ˜¯ PAT ç›®å‰æœ‰äº›ä½¿ç”¨ä¸Šçš„å›°å¢ƒï¼Œåœ¨äº†è§£é€™å€‹å›°å¢ƒå‰æˆ‘å€‘å¿…é ˆå…ˆè¬›ä¸€ä¸‹ä»€éº¼æ˜¯ Existential Container å’Œ Witness Tableã€‚&lt;/p&gt;

&lt;h2 id=&quot;existential--witness&quot;&gt;Existential &amp;amp; Witness&lt;/h2&gt;

&lt;p&gt;åœ¨ç¨‹å¼ç¢¼ä¸­æ‰“å‡º Protocol åç¨±æ™‚æœ‰å¹¾ç¨®æƒ…å¢ƒï¼Œæœ‰æ™‚æˆ‘å€‘ç”¨å®ƒä¾†åšç‚ºä¸€äº›ç´„æŸæ¢ä»¶ï¼Œæˆ–è€…æˆ‘å€‘ç›´æ¥æŠŠå®ƒåšç‚ºä¸€ç¨®ã€Œå‹åˆ¥ã€ã€‚ä¸çŸ¥é“å¤§å®¶æœ‰æ²’æœ‰æƒ³éï¼ŒProtocol æœ¬èº«å…¶å¯¦ä¸å…·å‚™å¯¦ä½œçš„å¯¦é«”ï¼Œä½†ç‚ºä»€éº¼å¯ä»¥ç•¶åšä¸€ç¨®å‹åˆ¥ä¾†ä½¿ç”¨å‘¢ï¼Ÿ&lt;/p&gt;

&lt;p&gt;é€™æ˜¯å› ç‚º Swift Compiler ä½¿ç”¨äº† Existential Container ï¼Œä¸‹ä¾‹ä¸­å…©å€‹çœ‹ä¼¼ç›¸åŒçš„ instance å…¶å¯¦å»æœ‰å®Œå…¨ä¸åŒçš„ memory layout&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-swift&quot; data-lang=&quot;swift&quot;&gt;&lt;span class=&quot;kd&quot;&gt;protocol&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;MyProcotol&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{}&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;MyStruct&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// What's the difference of following two?&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;existentialContainer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;MyProtocol&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;MyStruct&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;structInstance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;MyStruct&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;nf&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;MemoryLayout&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;ofValue&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;existentialContainer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 40&lt;/span&gt;
&lt;span class=&quot;nf&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;MemoryLayout&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;ofValue&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;structInstance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 16&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;åŸå› æ­£æ˜¯å› ç‚ºç•¶ä½ å°‡ä¸€å€‹å‹åˆ¥æ˜ç¢ºåœ° (Explicitly) æŒ‡ç‚ºä¸€å€‹ Protocol æ™‚ï¼Œæˆ‘å€‘æŒ‡çš„ä¸æ˜¯ä¸€å€‹å…·é«”çš„å¯¦é«”ï¼ˆå‹åˆ¥ï¼‰ï¼Œè€Œæ˜¯å¯¦ä½œäº†è©² Protocol è¦ç¯„çš„ã€Œæ‰€æœ‰å¯èƒ½ã€å‹åˆ¥éƒ½èƒ½å¥—ç”¨æ–¼æ­¤ï¼Œå¾ˆæ˜é¡¯é€™æ˜¯ä¸€å€‹ runtime æ‰èƒ½æ±ºå®šçš„äº‹æƒ…ï¼Œcompiler å¯èƒ½ç„¡æ³•åœ¨ compile time çŸ¥é“ä½ é€èª°é€²ä¾†ï¼Œæ–¼æ˜¯åœ¨é€™ç¨®æƒ…æ³ä¸‹ï¼Œæˆ‘å€‘éœ€è¦ä¸€å€‹è¬ç”¨çš„ä¸­é–“å±¤ï¼ˆæ²’æœ‰ä¸­é–“å±¤è§£æ±ºä¸äº†çš„äº‹å•Šï¼‰ï¼Œæ‰€ä»¥å…¶å¯¦ä½ æŒ‡å®šçš„ä¸¦ä¸æ˜¯ Protocol é€™å€‹å‹åˆ¥ï¼Œè€Œæ˜¯è©² Protocol çš„ Existential Container ã€‚&lt;/p&gt;

&lt;p&gt;ä¸€å€‹ Existential Container çµæ§‹å¦‚ä¸‹åœ–ï¼Œé•·åº¦æ˜¯ 5 å€‹ machine word ï¼Œå¯å¾å‰ä¾‹çš„ memory layout size å¾—çŸ¥&lt;/p&gt;

&lt;figure class=&quot;image&quot;&gt;
  &lt;img src=&quot;https://i.imgur.com/3pOt339.png&quot; alt=&quot;åœ–ç‰‡ä¾†æºï¼šhttps://developer.apple.com/videos/play/wwdc2016/416/&quot; /&gt;
  &lt;figcaption&gt;åœ–ç‰‡ä¾†æºï¼šhttps://developer.apple.com/videos/play/wwdc2016/416/&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;å…¶ä¸­ value buffer è¨˜éŒ„äº†å¯¦éš›å‹åˆ¥çš„ properties ï¼Œçœ‹åˆ°é€™ä½ ä¸€å®šé¦¬ä¸Šæƒ³ï¼Œ3 å€‹ word å“ªå¤ å•Šï¼Ÿï¼Ÿï¼Ÿ äº‹å¯¦ä¸Šæ˜¯ï¼Œè‹¥è¶…é 3 å€‹ word ä¾†å­˜æ”¾çš„ value type ï¼Œæœƒå†å¦å¤–è¦ä¸€å¡Šç©ºé–“ï¼Œvalue buffer è£¡å°±åªæœƒæ”¾ä¸€å€‹ pointer æŒ‡å‘é€™å€‹ç©ºé–“ï¼›åä¹‹å‰‡ä¾åºå­˜æ”¾ï¼Œæˆ‘å€‘å¯ä»¥å¾ä¸‹é¢çš„ç¯„ä¾‹ä¸­æ¢ç´¢ä¸€ä¸‹å¯¦éš›çš„æƒ…æ³ï¼š&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-swift&quot; data-lang=&quot;swift&quot;&gt;&lt;span class=&quot;kd&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;ExistentialContainer&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;valueBuffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;vwt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;UnsafePointer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;ValueWitness&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;pwt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;UnsafePointer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;ProtocolWitness&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;protocol&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Fooable&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Concrete&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Fooable&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;99&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nf&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;foo in concrete&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// In main.swift&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;concrete&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Fooable&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Concrete&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;nf&quot;&gt;withUnsafePointer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;concrete&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pointer&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;pointer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;withMemoryRebound&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;ExistentialContainer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;capacity&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;wpointer&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt;
        &lt;span class=&quot;nf&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wpointer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pointee&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valueBuffer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 99&lt;/span&gt;
        &lt;span class=&quot;nf&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wpointer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pointee&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valueBuffer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 2&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;ä¸Šä¾‹ä¸­çš„ ExistentialContainer struct å’Œå¯¦éš›ä¸Šçš„ memory layout æ˜¯ä¸€æ¨¡ä¸€æ¨£çš„ã€‚è€Œ vwt å€å¡Šå‰‡ å­˜æ”¾ä¸€å€‹æŒ‡å‘ Value Witness Table çš„ pointerï¼Œvalue witness table è¨˜è¼‰äº† value çš„ allocate, copy, destruct å’Œ deallocateï¼› è‡³æ–¼ pwt å‰‡æ˜¯æŒ‡å‘ Protocol Witness Table çš„ pointerï¼Œé€™è£¡å¯ä»¥æ‰¾åˆ°æ‰€æœ‰å¯¦ä½œäº† protocol è£¡ method çš„å¯¦é«”ä½ç½®ï¼ˆæ¬²çŸ¥æ›´å¤šç´°ç¯€ï¼Œæ¨è–¦æ”¶çœ‹ WWDC 2016 çš„ &lt;a href=&quot;https://developer.apple.com/videos/play/wwdc2016/416/&quot;&gt;Understanding Swift Performance&lt;/a&gt;ï¼‰&lt;/p&gt;

&lt;p&gt;é‚£ï¼Œç‚ºä»€éº¼è¦è¬›é€™å€‹ğŸ¤”&lt;/p&gt;

&lt;p&gt;å› ç‚º compiler ç„¡æ³•ç‚º PAT ç”Ÿæˆ Existential Container å•¦ï¼ï¼ï¼&lt;/p&gt;

&lt;p&gt;è‹¥ä½ ä¸€æ™‚ç„¡æ³•æ„æœƒé€™å¥è©±æ˜¯ä»€éº¼æ„æ€ï¼Œè«‹è©¦è‘—å¯«å‡ºé€™æ¨£çš„ code: &lt;code class=&quot;highlighter-rouge&quot;&gt;let sequences: [Sequence]&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;å¯«å®Œå¾Œä½ å°±æœƒå¾—åˆ°ä»¥ä¸‹è­¦å ±&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Protocol â€˜Sequenceâ€™ can only be used as a generic constraint because it has Self or associated type requirements.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;å¦‚æœé€™å€‹ä¾‹å­ä½ ç„¡æ³•æ„ŸåŒèº«å—çš„è©±ï¼Œè«‹å®¹è¨±æˆ‘å±•ç¤ºå¦ä¸€å€‹ä¾‹å­ï¼Œåœ¨ç°¡å–®çš„ç¶²è·¯è«‹æ±‚æƒ…å¢ƒä¸‹æˆ‘å¸¸ç”¨é€™å€‹å¾&lt;a href=&quot;https://onevcat.com/#blog&quot;&gt;å–µç¥&lt;/a&gt;é‚£å­¸ä¾†çš„ protocol-oriented newtork request architecture ï¼ˆä»¥ RxSwift å‘ˆç¾ï¼‰&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-swift&quot; data-lang=&quot;swift&quot;&gt;&lt;span class=&quot;kd&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Foundation&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;RxSwift&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Requests &lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;enum&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;HTTPMethod&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;POST&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;GET&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Define what a request is&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;protocol&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Request&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;get&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;method&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;HTTPMethod&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;get&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;param&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Any&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;get&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;associatedtype&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;ResponseObject&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Decodable&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Define what shoud have to send a request&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;protocol&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;RequestSender&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;base&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;get&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Request&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Observable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;ResponseObject&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// An object who can send out Request&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;URLSessionRequestSender&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;RequestSender&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;base&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;http://www.dummy.api&quot;&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Request&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Observable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;ResponseObject&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;url&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;URL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;base&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;appending&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;request&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;URLRequest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;httpMethod&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;method&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rawValue&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;body&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;JSONSerialization&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;withJSONObject&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;param&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prettyPrinted&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;httpBody&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;body&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Observable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;create&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;subscriber&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;task&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;  &lt;span class=&quot;kt&quot;&gt;URLSession&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shared&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;dataTask&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;error&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;object&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;JSONDecoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;decode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;ResponseObject&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;from&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;subscriber&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;onNext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;subscriber&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;onError&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;resume&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Disposables&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// An object&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;User&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Decodable&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gender&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// A real request&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;GetUserRequest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Request&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;typealias&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;ResponseObject&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;User&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;/users/&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;param&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Any&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;method&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;HTTPMethod&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;GET&lt;/span&gt;

    &lt;span class=&quot;nf&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;param&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Any&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[:])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;param&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;param&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// usage example&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;example&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;request&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;GetUserRequest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;a12345&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;param&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;foo&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;bar&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;URLSessionRequestSender&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;subscribe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;onNext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;user&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;let&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;user&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;user&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;nf&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;user is : &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;nf&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;got nothing&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;ä¸Šä¾‹å„ªé›…åœ°åˆ©ç”¨ associatedtype ä¾†æŠŠ Request ç›¸é—œçš„å…ƒç´ éƒ½é›†ä¸­åœ¨ä¸€å€‹è³‡æ–™çµæ§‹è£¡ï¼Œè®“æˆ‘å€‘å¯ä»¥ç”¨ä¸€å€‹ sender ï¼ˆä¹Ÿå¯ä»¥æ›¿æ›æˆä¸åŒå¯¦ä½œï¼‰ä¾†é€å‡ºå„ç¨®ä¸åŒçš„ request è€Œä¸” return type éƒ½æ˜¯åœ¨ compile time å°±èƒ½å¤ å¾—çŸ¥çš„ï¼Œthe power of generic and protocolï¼&lt;/p&gt;

&lt;p&gt;ç„¶è€Œï¼Œç•¶ä½ é–‹å§‹é–‹å¿ƒåœ°ç©ä¸‹å»ï¼Œç™¼ç¾ä½ æƒ³è¦æ¥å—å„å¼ä¸åŒ Request çš„ queue æ™‚ï¼Œä½ å¯«å‡ºäº† &lt;code class=&quot;highlighter-rouge&quot;&gt;var request: Request&lt;/code&gt;&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Protocol â€˜Requestâ€™ can only be used as a generic constraint because it has Self or associated type requirements.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;figure class=&quot;image&quot;&gt;
  &lt;img src=&quot;https://i.imgur.com/ntGKYSh.png&quot; alt=&quot;&quot; /&gt;
  &lt;figcaption&gt;&lt;/figcaption&gt;
&lt;/figure&gt;

&lt;p&gt;&lt;br /&gt;&lt;/p&gt;

&lt;p&gt;å¥½å§ï¼Œæ”¶æ¨ç ´ç¢çš„å¿ƒï¼Œ code é‚„æ˜¯è¦å¯«å®Œä¸ç„¶æœƒæ²’å·¥ä½œï¼Œé‡åˆ°é€™å€‹ç‹€æ³è©²æ€éº¼è¾¦å‘¢ï¼Ÿå…ˆè¬›çµ‚æ¥µçµè«–ï¼Œé€™å€‹å•é¡Œæ‡‰è©²å°±åœ¨ä¸ä¹…å¾Œçš„å°‡ä¾†å°±æœƒè¢«è§£æ±ºï¼ŒSwift ç¸½æœ‰ä¸€å¤©æœƒæ”¯æ´ let request: Request&amp;lt;ResponseObject: User&amp;gt; çš„å¯«æ³•ï¼ˆæˆ–è€…å¯èƒ½æ˜¯ some Requestï¼Œå¯ä»¥åƒè€ƒSE-0244ï¼‰ã€‚ä½†åœ¨é‚£å¤©åˆ°ä¾†å‰ï¼ŒSwift ç¤¾ç¾¤æœ‰å¾ˆå¤š workaround çš„è¨è«–ä»¥ç¹é–‹é€™å€‹å•é¡Œï¼Œtype erasure çš„æŠ€å·§å¦‚ AnyIteratorã€Any XXX ç­‰éƒ½å¯ä»¥ï¼Œä¸ééƒ½é‚„å¾ˆéº»ç…©è€Œä¸”ä¸€å®šè¦å†å¼•å…¥å¦ä¸€å€‹ containerã€‚ç›´åˆ°æœ€è¿‘æˆ‘çœ‹åˆ°ä¸€å€‹è®“æˆ‘ğŸ¤¯ğŸ¤¯ğŸ¤¯çš„å¤©æ‰æƒ³æ³•ï¼š&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Why donâ€™t you write Protocol Witness Table by yourselfï¼Ÿ&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;ä¸€å£æ°£è§£é–‹äº† PAT çš„å•é¡Œï¼Œæ›´æ‰“é–‹äº†ä¸€å€‹å¯¦é«”åªèƒ½æœ‰ä¸€ç¨® Protocol å¯¦ä½œçš„é™åˆ¶ï¼Œæ ¹æœ¬ç¥ä¹‹æ€ç¶­å•Šå•Šï¼ï¼ï¼&lt;/p&gt;

&lt;p&gt;æ¬²çŸ¥è©³æƒ…ï¼Œè«‹å‰å¾€&lt;a href=&quot;https://pofat.dev/2019/05/22/%E9%87%8D%E6%96%B0%E6%AA%A2%E8%A6%96-swift-%E7%9A%84-protocol-%E4%B8%89.html&quot;&gt;ç¬¬ä¸‰é›†&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;å¾Œè¨˜èˆ‡åƒè€ƒè³‡æ–™&quot;&gt;å¾Œè¨˜èˆ‡åƒè€ƒè³‡æ–™ï¼š&lt;/h3&gt;

&lt;p&gt;æœƒé–‹å§‹å‹•æ‰‹å¯«é€™ç¯‡å§‹æ–¼æœ€è¿‘å’Œå‹äºº Liyao Chen é‚„æœ‰ Ethan Huang ç›´æ¥é–“æ¥åœ°å°èŠã€æä¾›è³‡æ–™å’Œæˆ‘å€‹äººè…¦è£œï¼Œåˆçœ‹åˆ° Rob Napier å“¥é‡å‡ºæ±Ÿæ¹–&lt;a href=&quot;http://robnapier.net/&quot;&gt;è¬› protocol&lt;/a&gt;ï¼ˆç²¾å½©å‹¿éŒ¯éï¼‰ä»¥åŠ Brandon Willams å’Œå°æ­¤è­°é¡Œçš„ç¥ä¹‹åˆ‡å…¥è§’åº¦ï¼Œå°±å°‡é€™æ®µæ­·ç¨‹å¯«ä¸‹ä¾†ã€‚&lt;/p&gt;

&lt;h3 id=&quot;å¾Œè¨˜å…¶äºŒ-201985&quot;&gt;å¾Œè¨˜å…¶äºŒ (2019.8.5)&lt;/h3&gt;
&lt;p&gt;é€™ç¯‡æ–‡å¯«å®Œå¾Œä¸åˆ°ä¸€å€‹æœˆï¼Œåœ¨ WWDC 2019 å°±çœ‹åˆ°ä»¤äººçˆ†ç‚¸çš„ SwiftUIï¼Œå…¶ä¸­çš„ &lt;code class=&quot;highlighter-rouge&quot;&gt;some View&lt;/code&gt; é€™ç¨®å¯«æ³•å°¤æ˜¯æƒ¹äººå´ç›®ï¼Œé€™å°±æ˜¯ SE-0244 çš„å¯¦ä½œï¼Œä¹Ÿè©²æ˜¯æ™‚å€™å¥½å¥½äº†è§£ä¸€ä¸‹å®ƒæ˜¯ä»€éº¼ï¼Œæ‰€ä»¥å†å¦èµ·ä¸€æ–‡èªªæ˜é€™å€‹ç‰¹æ€§ - &lt;a href=&quot;https://pofat.dev/2019/08/05/Opaque-Result-Type.html&quot;&gt;Opaque Result Type&lt;/a&gt;ã€‚&lt;/p&gt;</content><author><name>Pofat</name></author><category term="Swift" /><category term="Protocol" /><summary type="html">ç‚ºä½•å†è¬› Protocol</summary></entry></feed>